<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3c.org/TR/html4/loose.dtd">
<html><head>
<title>OpenAFS Security Info</title>
<link href="/openafs.css" rel="stylesheet" type="text/css">
</head>
<body bgcolor="#ffffff" text="#000000"
      link="#000fff" vlink="#0000ff" alink="#0000ff">

<h1>OpenAFS Security Advisories</h1>
<p>The following are overviews of security advisories issued by the
OpenAFS Project regarding known security problems in OpenAFS and its
components.  Each overview includes a summary of the problem, a link
to the full text of the advisory.  When they are available, patches
are also included.

At the end of this document is a <a href="#salist">table of all
OpenAFS security advisories</a>.

<p>If you want to report security problems or issues with OpenAFS,
you may send mail to the OpenAFS security officer at
<a href="mailto:security@openafs.org">security@openafs.org</a>.
When sending sensitive information, we ask that you encrypt it
with PGP.

<hr>

<a name="OPENAFS-SA-2013-004"></a>
<h2>OPENAFS-SA-2013-004 - vos -encrypt doesn't encrypt connection data</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>24-Jul-2013</td></tr>
<tr><th align="left">Last Update:</th><td>24-Jul-2013</td></tr>
<tr><th align="left">Affected:</th><td>
  OpenAFS client versions 1.6.1 through 1.6.4</td></tr>
<tr><th align="left">Patch:</th><td>
  <a href="openafs-sa-2013-004.patch">
  http://www.openafs.org/security/openafs-sa-2013-004.patch</a><br>
</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2013-004.txt">
  http://www.openafs.org/security/OPENAFS-SA-2013-004.txt</a>
</td></tr>
</table>
<p>An attacker can read data which an administrator expected to remain private.</p>

<a name="OPENAFS-SA-2013-003"></a>
<h2>OPENAFS-SA-2013-003 - Brute force DES attack permits compromise of AFS cell</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>24-Jul-2013</td></tr>
<tr><th align="left">Last Update:</th><td>24-Jul-2013</td></tr>
<tr><th align="left">Affected:</th><td>
  OpenAFS servers before versions 1.4.15 and 1.6.5</td></tr>
<tr><th align="left">Instructions:</th><td>
  <a href="how-to-rekey.txt">
  How to rekey your cell</a><br>
  <a href="install-rxkad-k5-1.6.txt">
  How to install rxkad k5 support for servers running OpenAFS 1.6</a><br>
  <a href="install-rxkad-k5-1.4.txt">
  How to install rxkad k5 support for servers running OpenAFS 1.4</a>
</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2013-003.txt">
  http://www.openafs.org/security/OPENAFS-SA-2013-003.txt</a>
</td></tr>
</table>
<p>The small size of the DES key space permits an attacker to brute
force a cell's service key and then forge traffic from any user
within the cell. The key space search can be performed in under 1
day at a cost of around $100 using publicly available services.</p>

<a name="OPENAFS-SA-2013-002"></a>
<h2>OPENAFS-SA-2013-002 - Buffer overflow in OpenAFS ptserver</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>27-Feb-2013</td></tr>
<tr><th align="left">Last Update:</th><td>27-Feb-2013</td></tr>
<tr><th align="left">Affected:</th><td>
  OpenAFS servers before version 1.6.2</td></tr>
<tr><th align="left">Patch:</th><td>
  <a href="openafs-sa-2013-002.patch">
  http://www.openafs.org/security/openafs-sa-2013-002.patch</a><br>
  <a href="openafs-sa-2013-002-1_4_14_1.patch">
  http://www.openafs.org/security/openafs-sa-2013-002-1_4_14_1.patch (for 1.4.14.1)</a>
</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2013-002.txt">
  http://www.openafs.org/security/OPENAFS-SA-2013-002.txt</a>
</td></tr>
</table>
<p>An attacker can crash an OpenAFS ptserver by sending an IdToName RPC with
a large payload. This vulnerability is being tracked as CVE-2013-1795.</p>

<a name="OPENAFS-SA-2013-001"></a>
<h2>OPENAFS-SA-2013-001 - Buffer overflows in OpenAFS fileserver</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>27-Feb-2013</td></tr>
<tr><th align="left">Last Update:</th><td>27-Feb-2013</td></tr>
<tr><th align="left">Affected:</th><td>
 OpenAFS servers before version 1.6.2</td></tr>
<tr><th align="left">Patch:</th><td>
  <a href="openafs-sa-2013-001.patch">
  http://www.openafs.org/security/openafs-sa-2013-001.patch</a><br>
  <a href="openafs-sa-2013-001-1_4_14_1.patch">
  http://www.openafs.org/security/openafs-sa-2013-001-1_4_14_1.patch (for 1.4.14.1)</a>
</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2013-001.txt">
  http://www.openafs.org/security/OPENAFS-SA-2013-001.txt</a>
</td></tr>
</table>
<p>By carefully crafting an ACL entry an attacker may overflow fixed length 
buffers within the OpenAFS fileserver, crashing the fileserver, and 
potentially permitting the execution of arbitrary code. To perform the
exploit, the attacker must already have permissions to create ACLs on the
fileserver in question. This vulnerability is being tracked as CVE-2013-1794.</p>

<a name="OPENAFS-SA-2011-001"></a>
<h2>OPENAFS-SA-2011-001 - Denial of service attack against Rx server processes</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>23-Feb-2011</td></tr>
<tr><th align="left">Last Update:</th><td>23-Feb-2011</td></tr>
<tr><th align="left">Affected:</th><td>
  OpenAFS servers versions 1.2.8 - 1.4.12.1, 1.5.0-1.5.74 for all platforms</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2011-001.txt">
  http://www.openafs.org/security/OPENAFS-SA-2011-001.txt</a>
</td></tr>
</table>
<p>An attacker with control of a client, or the ability to forge RX packets,
can crash a server of affected hosts.
This vulnerability is being tracked as CVE-2011-0430.</p>

<p>Currently the advisory erroneously states 1.4.14 is vulnerable.</p>

<p>CVE-2011-0431, while correctly describing 1.4.14 as containing the fix
for this issue, describes in its summary the release as broken. It is not.
We recommend sites upgrade to 1.4.14; However, the impact of the issue
is limited to a denial of service attack by a user with the ability to
affect a lock of AFS though the client on a host.</p>

<a name="OPENAFS-SA-2009-002"></a>
<h2>OPENAFS-SA-2009-002 - Denial of service attack against Linux cache manager</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>6-Apr-2009</td></tr>
<tr><th align="left">Last Update:</th><td>6-Apr-2009</td></tr>
<tr><th align="left">Severity:</th><td>Medium</td></tr>
<tr><th align="left">Affected:</th><td>
  OpenAFS 1.0-1.4.8, OpenAFS 1.5.0-1.5.58</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2009-002.txt">
  http://www.openafs.org/security/OPENAFS-SA-2009-002.txt</a>
</td></tr>
</table>

<p>AFS may pass an error code obtained from the fileserver directly to the
Linux kernel, using a Linux mechanism that merges error codes and pointers 
into a single value. However, this mechanism is unable to distinguish certain
error codes from pointers. When AFS returns a code of this type to the kernel,
the kernel treats it as a pointer and attempts to dereference it. This causes a
kernel panic, and results in a denial of service attack.</p>

<p>There are no known publicly-available exploits for this vulnerability at
this time. 

<hr>
<a name="OPENAFS-SA-2009-001"></a>
<h2>OPENAFS-SA-2009-001 - Network based buffer overflow attack against Unix cache manager</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>6-Apr-2009</td></tr>
<tr><th align="left">Last Update:</th><td>6-Apr-2009</td></tr>
<tr><th align="left">Severity:</th><td>Medium</td></tr>
<tr><th align="left">Affected:</th><td>
  OpenAFS 1.0-1.4.8, OpenAFS 1.5.0-1.5.58</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2009-001.txt">
  http://www.openafs.org/security/OPENAFS-SA-2009-001.txt</a>
</td></tr>
</table>

<p>AFS's XDR data marshalling language permits the construction of arrays with a
size constrained by the interface definition. The XDR decoding language will
accept data from the server up to this maximum size, which in some cases is
stored into a buffer allocated by the client. 

In several locations, the AFS client assumes that the server will never
return more data than requested, and so allocates a buffer smaller than this
maximum size. Whilst this causes no problems when communicating with valid
servers, an attacker can return more data than expected, and overflow the
client's buffer.</p>

<p>There are no known publicly-available exploits for this vulnerability at
this time. 

<hr>
<a name="OPENAFS-SA-2007-003"></a>
<h2>OPENAFS-SA-2007-003 - denial of service in OpenAFS fileserver</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>20-Dec-2007</td></tr>
<tr><th align="left">Last Update:</th><td>21-Dec-2007</td></tr>
<tr><th align="left">Severity:</th><td>Medium</td></tr>
<tr><th align="left">Affected:</th><td>
  OpenAFS 1.3.50-1.4.5, OpenAFS 1.5.0-1.5.27</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2007-003.txt">
  http://www.openafs.org/security/OPENAFS-SA-2007-003.txt</a>
</td></tr>
</table>

<p>The AFS fileserver tracks client callbacks on files via a series of 
linked lists internally. When a client acquires a new callback or gives up
an old one, these lists must be updated. Beginning in 1.3.50, a bulk disposal
mechanism was added. Due to a failure to hold a lock, unsafe access to data
could result in a crash. No data compromise is known.</p>

<p>There are no known publicly-available exploits for this vulnerability at
this time. 

<hr>

<a name="OPENAFS-SA-2007-002"></a>
<h2>OPENAFS-SA-2007-002 - OpenAFS for Windows clients denial of service vulnerability</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>19-Apr-2007</td></tr>
<tr><th align="left">Last Update:</th><td>19-Apr-2007</td></tr>
<tr><th align="left">Severity:</th><td>Medium</td></tr>
<tr><th align="left">Affected:</th><td>
  OpenAFS 1.3.64-1.3.99, OpenAFS 1.4.0-1.4.4, OpenAFS 1.5.0-1.5.18</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2007-002.txt">
  http://www.openafs.org/security/OPENAFS-SA-2007-002.txt</a>
</td></tr>
</table>

<p>OpenAFS for Windows installs a Network Provider module, afslogon.dll, which
is loaded by the Windows Logon service, winlogon.exe. When MIT Kerberos for
Windows is installed, afslogon.dll will attempt to perform operations that
involve the Kerberos v5 libraries. Successful use of Kerberos v5 requires
the ability to establish a krb5_context. Parsing errors in the Kerberos v5
configuration profile, krb5.ini, will prevent the successful creation of a
krb5_context. afslogon.dll attempts to free a krb5_context whether or
not it was successfully established. This produces a memory access error that
in turn forces the Windows Logon Service to terminate unexpectedly and causes
Microsoft Windows to halt.</p>

<p>There are no known publicly-available exploits for this vulnerability at
this time. 

<hr>

<a name="OPENAFS-SA-2007-001"></a>
<h2>OPENAFS-SA-2007-001 - setuid (privilege escalation) in OpenAFS Unix based clients</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>20-Mar-2007</td></tr>
<tr><th align="left">Last Update:</th><td>20-Mar-2007</td></tr>
<tr><th align="left">Severity:</th><td>Medium</td></tr>
<tr><th align="left">Affected:</th><td>
  OpenAFS 1.0-1.4.3, OpenAFS 1.5.0-1.5.16</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2007-001.txt">
  http://www.openafs.org/security/OPENAFS-SA-2007-001.txt</a>
</td></tr>
</table>

<p>Because AFS cache managers do not use authenticated connections for 
non-user-authenticated sessions, checks for cache coherency are done 
over an unprotected connection if they are not being done for an
authenticated user. Because of this it is possible to spoof a false
status for files in the cache.

<p>The AFS cache manager on platforms which offer privilege based on file modes
are vulnerable to such attacks.  

<p>There are no known publicly-available exploits for this vulnerability at
this time. 

<hr>

<a name="OPENAFS-SA-2003-002"></a>
<h2>OPENAFS-SA-2003-002 - Rx connection hijacking vulnerability</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>18-Apr-2003</td></tr>
<tr><th align="left">Last Update:</th><td>18-Apr-2003</td></tr>
<tr><th align="left">Severity:</th><td>Medium</td></tr>
<tr><th align="left">Affected:</th><td>
  OpenAFS 1.0-1.2.7, OpenAFS 1.3.0-1.3.2</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2003-002.txt">
  http://www.openafs.org/security/OPENAFS-SA-2003-002.txt</a>
<tr><th align="left">Patch:</th><td>
  <a href="openafs-sa-2003-002.patch">
  http://www.openafs.org/security/openafs-sa-2003-002.patch</a>
  <a href="openafs-sa-2003-002.patch.asc">(PGP signature)</a>
</td></tr>
</table>

<p>There is a bug in the Rx RPC protocol, used by AFS, which can be exploited
by an attacker to hijack arbitrary Rx connections.  This allows the
attacker to mount a denial of service attack by breaking arbitrary Rx
connections.  Additionally, unless encryption is used, such as rxkad mode
crypt ("fs setcrypt on") and the user accessing files is authenticated
(has valid tokens), the attacker can observe and modify the data being
transferred.

<p>The AFS cache manager and other AFS administrative clients (such as pts,
fs, vos, etc) are vulnerable to these attacks.  Vulnerable AFS servers
allow connections from AFS cache managers to be hijacked, but not
connections from the other AFS administrative clients (such as pts, fs,
vos, etc).

<p>There are no known publicly-available exploits for this vulnerability at
this time.

<hr>

<a name="OPENAFS-SA-2003-001"></a>
<h2>OPENAFS-SA-2003-001 - Cryptographic weakness in Kerberos v4</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>25-Mar-2003</td></tr>
<tr><th align="left">Last Update:</th><td>25-Mar-2003</td></tr>
<tr><th align="left">Severity:</th><td>High</td></tr>
<tr><th align="left">Affected:</th><td>
  OpenAFS 1.0-1.2.8, OpenAFS 1.3.0-1.3.2</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2003-001.txt">
  http://www.openafs.org/security/OPENAFS-SA-2003-001.txt</a>
<tr><th align="left">Patch:</th><td>
  <a href="kaserver-disable-krb4-crossrealm-20030317.delta">
  http://www.openafs.org/security/kaserver-disable-krb4-crossrealm-20030317.delta</a>
  <a href="kaserver-disable-krb4-crossrealm-20030317.delta.asc">(PGP signature)</a>
</td></tr>
</table>

<p>A cryptographic weakness in version 4 of the Kerberos protocol allows an
attacker to use a chosen-plaintext attack to impersonate any principal in
a realm.  OpenAFS kaserver implements version 4 of the Kerberos protocol,
and therefore is vulnerable.  An attacker that knows a shared cross-realm
key between any remote realm and the local realm can impersonate any
principal in the local realm to AFS database servers and file servers in
the local cell, and other services in the local realm.  An attacker that
can create arbitrary principal names in a realm can also impersonate any
principal in that realm.

<p>If your realm has no shared keys, and does not allow users to create
arbitrary principal names, you are not exposed to this vulnerability.

<p>There are no known publicly-available exploits for this vulnerability at
this time.

<hr>

<a name="OPENAFS-SA-2002-001"></a>
<h2>OPENAFS-SA-2002-001 - xdr_array integer overflow</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>03-Aug-2002</td></tr>
<tr><th align="left">Last Update:</th><td>03-Aug-2002</td></tr>
<tr><th align="left">Severity:</th><td>High</td></tr>
<tr><th align="left">Affected:</th><td>
  OpenAFS 1.0-1.2.5, OpenAFS 1.3.0-1.3.2</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2002-001.txt">
  http://www.openafs.org/security/OPENAFS-SA-2002-001.txt</a>
<tr><th align="left">Patch:</th><td>
  <a href="xdr-updates-20020731.delta">
  http://www.openafs.org/security/xdr-updates-20020731.delta</a> <a href="xdr-updates-20020731.delta.asc">(PGP signature)</a>
</td></tr>
</table>

<p>There is an integer overflow bug in the SUNRPC-derived RPC library
used by OpenAFS that could be exploited to crash certain OpenAFS
servers (volserver, vlserver, ptserver, buserver) or to obtain
unauthorized root access to a host running one of these processes.

<p>In addition, it is possible for a rogue server to attack certain
administrative clients (vos, pts, backup, butc, rxstat), but only
if certain RPC requests are made to the rogue server.

<p>The OpenAFS fileserver and cache manager (client) are not vulnerable
to these attacks.  No exploits are presently known to be available
for this vulnerability.

<hr>

<a name="salist"></a>
<h2>Overview of all OpenAFS Security Advisories</h2>
<table border=1>
<tr>
  <th>ID</th><th>Issued</th><th>Updated</th>
  <th>Severity</th><th>Versions Affected</th><th>topic</th>
</tr>
<tr>
  <td>2002-001</td><td>03-Aug-2002</td><td>03-Aug-2002</td>
  <td>High</td><td>1.0-1.2.5, 1.3.0-1.3.2</td>
  <td><a href="#OPENAFS-SA-2002-001">xdr_array integer overflow</a></td>
</tr>
<tr>
  <td>2003-001</td><td>25-Mar-2003</td><td>25-Mar-2003</td>
  <td>High</td><td>1.0-1.2.8, 1.3.0-1.3.2</td>
  <td><a href="#OPENAFS-SA-2003-001">Cryptographic weakness in Kerberos v4</a></td>
</tr>
<tr>
  <td>2003-002</td><td>18-Apr-2003</td><td>18-Apr-2003</td>
  <td>Medium</td><td>1.0-1.2.7, 1.3.0-1.3.2</td>
  <td><a href="#OPENAFS-SA-2003-002">Rx connection hijacking vulnerability</a></td>
</tr>
<tr>
  <td>2007-001</td><td>20-Mar-2007</td><td>20-Mar-2007</td>
  <td>Medium</td><td>1.0-1.4.3, 1.5.0-1.5.16</td>
  <td><a href="#OPENAFS-SA-2007-001">setuid (privilege escalation) in OpenAFS Unix based clients</a></td>
</tr>
<tr>
  <td>2007-002</td><td>19-Apr-2007</td><td>19-Apr-2007</td>
  <td>Medium</td><td>1.3.64-1.4.4, 1.5.0-1.5.18</td>
  <td><a href="#OPENAFS-SA-2007-002">OpenAFS for Windows clients denial of service vulnerability</a></td>
</tr>
<tr>
  <td>2007-003</td><td>20-Dec-2007</td><td>21-Dec-2007</td>
  <td>Medium</td><td>1.3.50-1.4.5, 1.5.0-1.5.27</td>
  <td><a href="#OPENAFS-SA-2007-003">denial of service in OpenAFS fileserver</a></td>
</tr>
<tr>
  <td>2009-001</td><td>06-Apr-2009</td><td>06-Apr-2009</td>
  <td>Medium</td><td>1.0-1.4.8, 1.5.0-1.5.58</td>
  <td><a href="#OPENAFS-SA-2009-001">Network based buffer overflow attack against Unix cache manager</a></td>
</tr>
<tr>
  <td>2009-002</td><td>06-Apr-2009</td><td>06-Apr-2009</td>
  <td>Medium</td><td>1.0-1.4.8, 1.5.0-1.5.58</td>
  <td><a href="#OPENAFS-SA-2009-002">Denial of service attack against Linux cache manager</a></td>
</tr>
<tr>
  <td>2011-001</td><td>23-Feb-2011</td><td>23-Feb-2011</td>
  <td>Medium</td><td>1.2.8-1.4.12.1, 1.5.0-1.5.74</td>
  <td><a href="#OPENAFS-SA-2011-001">Denial of service attack against Rx server processes</a></td>
</tr>
<tr>
  <td>2013-001</td><td>27-Feb-2013</td><td>27-Feb-2013</td>
  <td>High</td><td>1.0-1.6.1</td>
  <td><a href="#OPENAFS-SA-2013-001">Buffer overflows in OpenAFS fileserver</a></td>
</tr>
<tr>
  <td>2013-002</td><td>27-Feb-2013</td><td>27-Feb-2013</td>
  <td>High</td><td>1.0-1.6.1</td>
  <td><a href="#OPENAFS-SA-2013-002">Buffer overflow in OpenAFS ptserver</a></td>
</tr>
<tr>
  <td>2013-003</td><td>24-Jul-2013</td><td>24-Jul-2013</td>
  <td>High</td><td>1.0-1.4.14,1.5.0-1.6.4</td>
  <td><a href="#OPENAFS-SA-2013-003">Brute force DES attack permits compromise of AFS cell</a></td>
</tr>
<tr>
  <td>2013-004</td><td>24-Jul-2013</td><td>24-Jul-2013</td>
  <td>High</td><td>1.6.1-1.6.4</td>
  <td><a href="#OPENAFS-SA-2013-004">vos -encrypt doesn't encrypt connection data</a></td>
</tr>
</table>


<div id="footer"><hr>
<address>&lt;webmaster@openafs.org&gt;</address>
<address>Last modified: $Date$</address>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-5995928-1");
pageTracker._trackPageview();
</script>
</body></html>
