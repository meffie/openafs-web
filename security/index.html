<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3c.org/TR/html4/loose.dtd">
<html><head>
<title>OpenAFS Security Info</title>
<link href="/openafs.css" rel="stylesheet" type="text/css">
</head>
<body bgcolor="#ffffff" text="#000000"
      link="#000fff" vlink="#0000ff" alink="#0000ff">

<h1>OpenAFS Security Advisories</h1>
<p>The following are overviews of security advisories issued by the
OpenAFS Project regarding known security problems in OpenAFS and its
components.  Each overview includes a summary of the problem, a link
to the full text of the advisory.  When they are available, patches
are also included.

At the end of this document is a <a href="#salist">table of all
OpenAFS security advisories</a>.

<p>If you want to report security problems or issues with OpenAFS,
you may send mail to the OpenAFS security officer at
<a href="mailto:security@openafs.org">security@openafs.org</a>.
When sending sensitive information, we ask that you encrypt it
with PGP.

<hr>

<a name="OPENAFS-SA-2007-001"></a>
<h2>OPENAFS-SA-2007-001 - setuid (privilege escalation) in OpenAFS Unix based clients</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>20-Mar-2007</td></tr>
<tr><th align="left">Last Update:</th><td>20-Mar-2007</td></tr>
<tr><th align="left">Severity:</th><td>Medium</td></tr>
<tr><th align="left">Affected:</th><td>
  OpenAFS 1.0-1.4.3, OpenAFS 1.5.0-1.5.16</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2007-001.txt">
  http://www.openafs.org/security/OPENAFS-SA-2007-001.txt</a>
</td></tr>
</table>

<p>Because AFS cache managers do not use authenticated connections for 
non-user-authenticated sessions, checks for cache coherency are done 
over an unprotected connection if they are not being done for an
authenticated user. Because of this it is possible to spoof a false
status for files in the cache.

<p>The AFS cache manager on platforms which offer privilege based on file modes
are vulnerable to such attacks.  

<p>There are no known publicly-available exploits for this vulnerability at
this time. 

<hr>

<a name="OPENAFS-SA-2003-002"></a>
<h2>OPENAFS-SA-2003-002 - Rx connection hijacking vulnerability</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>18-Apr-2003</td></tr>
<tr><th align="left">Last Update:</th><td>18-Apr-2003</td></tr>
<tr><th align="left">Severity:</th><td>Medium</td></tr>
<tr><th align="left">Affected:</th><td>
  OpenAFS 1.0-1.2.7, OpenAFS 1.3.0-1.3.2</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2003-002.txt">
  http://www.openafs.org/security/OPENAFS-SA-2003-002.txt</a>
<tr><th align="left">Patch:</th><td>
  <a href="openafs-sa-2003-002.patch">
  http://www.openafs.org/security/openafs-sa-2003-002.patch</a>
  <a href="openafs-sa-2003-002.patch.asc">(PGP signature)</a>
</td></tr>
</table>

<p>There is a bug in the Rx RPC protocol, used by AFS, which can be exploited
by an attacker to hijack arbitrary Rx connections.  This allows the
attacker to mount a denial of service attack by breaking arbitrary Rx
connections.  Additionally, unless encryption is used, such as rxkad mode
crypt ("fs setcrypt on") and the user accessing files is authenticated
(has valid tokens), the attacker can observe and modify the data being
transferred.

<p>The AFS cache manager and other AFS administrative clients (such as pts,
fs, vos, etc) are vulnerable to these attacks.  Vulnerable AFS servers
allow connections from AFS cache managers to be hijacked, but not
connections from the other AFS administrative clients (such as pts, fs,
vos, etc).

<p>There are no known publicly-available exploits for this vulnerability at
this time.

<hr>

<a name="OPENAFS-SA-2003-001"></a>
<h2>OPENAFS-SA-2003-001 - Cryptographic weakness in Kerberos v4</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>25-Mar-2003</td></tr>
<tr><th align="left">Last Update:</th><td>25-Mar-2003</td></tr>
<tr><th align="left">Severity:</th><td>High</td></tr>
<tr><th align="left">Affected:</th><td>
  OpenAFS 1.0-1.2.8, OpenAFS 1.3.0-1.3.2</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2003-001.txt">
  http://www.openafs.org/security/OPENAFS-SA-2003-001.txt</a>
<tr><th align="left">Patch:</th><td>
  <a href="kaserver-disable-krb4-crossrealm-20030317.delta">
  http://www.openafs.org/security/kaserver-disable-krb4-crossrealm-20030317.delta</a>
  <a href="kaserver-disable-krb4-crossrealm-20030317.delta.asc">(PGP signature)</a>
</td></tr>
</table>

<p>A cryptographic weakness in version 4 of the Kerberos protocol allows an
attacker to use a chosen-plaintext attack to impersonate any principal in
a realm.  OpenAFS kaserver implements version 4 of the Kerberos protocol,
and therefore is vulnerable.  An attacker that knows a shared cross-realm
key between any remote realm and the local realm can impersonate any
principal in the local realm to AFS database servers and file servers in
the local cell, and other services in the local realm.  An attacker that
can create arbitrary principal names in a realm can also impersonate any
principal in that realm.

<p>If your realm has no shared keys, and does not allow users to create
arbitrary principal names, you are not exposed to this vulnerability.

<p>There are no known publicly-available exploits for this vulnerability at
this time.

<hr>

<a name="OPENAFS-SA-2002-001"></a>
<h2>OPENAFS-SA-2002-001 - xdr_array integer overflow</h2>
<table border=0>
<tr><th align="left">Issued:</th><td>03-Aug-2002</td></tr>
<tr><th align="left">Last Update:</th><td>03-Aug-2002</td></tr>
<tr><th align="left">Severity:</th><td>High</td></tr>
<tr><th align="left">Affected:</th><td>
  OpenAFS 1.0-1.2.5, OpenAFS 1.3.0-1.3.2</td></tr>
<tr><th align="left">Full Text:</th><td>
  <a href="OPENAFS-SA-2002-001.txt">
  http://www.openafs.org/security/OPENAFS-SA-2002-001.txt</a>
<tr><th align="left">Patch:</th><td>
  <a href="xdr-updates-20020731.delta">
  http://www.openafs.org/security/xdr-updates-20020731.delta</a> <a href="xdr-updates-20020731.delta.asc">(PGP signature)</a>
</td></tr>
</table>

<p>There is an integer overflow bug in the SUNRPC-derived RPC library
used by OpenAFS that could be exploited to crash certain OpenAFS
servers (volserver, vlserver, ptserver, buserver) or to obtain
unauthorized root access to a host running one of these processes.

<p>In addition, it is possible for a rogue server to attack certain
administrative clients (vos, pts, backup, butc, rxstat), but only
if certain RPC requests are made to the rogue server.

<p>The OpenAFS fileserver and cache manager (client) are not vulnerable
to these attacks.  No exploits are presently known to be available
for this vulnerability.

<hr>

<a name="salist"></a>
<h2>Overview of all OpenAFS Security Advisories</h2>
<table border=1>
<tr>
  <th>ID</th><th>Issued</th><th>Updated</th>
  <th>Severity</th><th>Versions Affected</th><th>topic</th>
</tr>
<tr>
  <td>2002-001</td><td>03-Aug-2002</td><td>03-Aug-2002</td>
  <td>High</td><td>1.0-1.2.5, 1.3.0-1.3.2</td>
  <td><a href="#OPENAFS-SA-2002-001">xdr_array integer overflow</a></td>
</tr>
<tr>
  <td>2003-001</td><td>25-Mar-2003</td><td>25-Mar-2003</td>
  <td>High</td><td>1.0-1.2.8, 1.3.0-1.3.2</td>
  <td><a href="#OPENAFS-SA-2003-001">Cryptographic weakness in Kerberos v4</a></td>
</tr>
<tr>
  <td>2003-002</td><td>18-Apr-2003</td><td>18-Apr-2003</td>
  <td>Medium</td><td>1.0-1.2.7, 1.3.0-1.3.2</td>
  <td><a href="#OPENAFS-SA-2003-002">Rx connection hijacking vulnerability</a></td>
</tr>
</table>


<div id="footer"><hr>
<address>&lt;webmaster@openafs.org&gt;</address>
<address>Last modified: $Date$</address>
</div></body></html>
