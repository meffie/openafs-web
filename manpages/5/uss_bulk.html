<html><head><title>uss_bulk</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="style" type="text/css" href="../style.css" media="all" >

</head>
<body class='pod'>
<!--
  generated by OpenAFS::HTML v1.1,
  using Pod::Simple::PullParser v2.02,
  under Perl v5.010000 at Fri Jun  6 16:43:00 2008 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to OpenAFS::HTML, and/or subclassing OpenAFS::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of OpenAFS::HTML for advice.
   See 'perldoc OpenAFS::HTML' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>uss_bulk - Provides instructions for the uss bulk command</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The uss bulk input file lists instructions for the <b>uss</b> command interpreter to execute when running the <b>uss bulk</b> command.
If the file includes <code>add</code> instructions that reference a <b>uss</b> template file,
then the template file must also exist.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Summary_of_Bulk_Input_File_Instructions"
>Summary of Bulk Input File Instructions</a></h2>

<p>The bulk input file can include the following instructions,
each on its own line.
A more detailed description of each instruction&#39;s syntax follows this list.</p>

<dl>
<dt><a name="add"
>add</a></dt>

<dd>
<p>Creates a user account.
Equivalent to the <b>uss add</b> command.</p>

<dt><a name="delete"
>delete</a></dt>

<dd>
<p>Deletes a user account.
Equivalent to the <b>uss delete</b> command.</p>

<dt><a name="delvolume"
>delvolume</a></dt>

<dd>
<p>Removes the volume and VLDB entry for each account referenced by a <code>delete</code> instruction that follows this instruction in the bulk input file.</p>

<dt><a name="exec"
>exec</a></dt>

<dd>
<p>Executes a command.</p>

<dt><a name="savevolume"
>savevolume</a></dt>

<dd>
<p>Preserves the volume and VLDB entry for each account referenced by a <code>delete</code> instruction that follows this instruction in the bulk input file.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_add_Instruction_for_Creating_an_Account"
>The add Instruction for Creating an Account</a></h2>

<p>The <code>add</code> instruction creates a user account.
Each instance in the bulk input file is equivalent in effect to a <b>uss add</b> command issued on the command line.
The order of the instruction&#39;s fields matches the order of arguments to the <b>uss add</b> command,
although some arguments do not have a corresponding field.
Like the <b>uss add</b> command&#39;s arguments,
many of the fields correspond to (provide a value for) a variable in the <b>uss</b> template file,
as indicated in the following description of each field.</p>

<p>The instruction&#39;s syntax is as follows.
It appears on multiple lines here only for the sake of legibility -- each <code>add</code> instruction must appear on a single line in the bulk input file.</p>

<pre>   add &#60;username&#62;[:&#60;full_name&#62;][:&#60;password&#62;][:&#60;expires&#62;]
       [:&#60;file_server&#62;][:&#60;partition&#62;][:&#60;mount_point&#62;][:&#60;uid&#62;]
       [:&#60;var1&#62;][:&#60;var2&#62;][:&#60;var3&#62;][:&#60;var4&#62;][:&#60;var5&#62;][:&#60;var6&#62;][:&#60;var7&#62;]
       [:&#60;var8&#62;][:&#60;var9&#62;][:]</pre>

<p>To omit a value for a field (presumably because it is optional or the template specifies a constant value for it), type nothing between the two colons that surround it. After the last argument provided, end the line with either a colon and carriage return, or a carriage return alone.</p>

<p>The meaning of, and acceptable values for, each field are as follows.</p>

<dl>
<dt><a name="&#60;username&#62;"
>&#60;username&#62;</a></dt>

<dd>
<p>Names the user&#39;s Authentication Database and Protection Database entries. It can include up to eight alphanumeric characters, but not the <code>:</code> (colon), <code>.</code> (period), or <code>@</code> (at-sign) characters. Because it becomes the username (the name under which a user logs in), it is best not to include shell metacharacters and to obey the restrictions that many operating systems impose on usernames (usually, to contain no more than eight lowercase letters).</p>

<p>Corresponding argument to the <b>uss add</b> command: <b>-user</b>. Corresponding variable in the template file: $USER.</p>

<dt><a name="&#60;full_name&#62;"
>&#60;full_name&#62;</a></dt>

<dd>
<p>Specifies the user&#39;s full name. Do not surround it with double quotes (<code>&#34;&#34;</code>), even if it contains spaces. If not provided, it defaults to the username in the &#60;username&#62; field.</p>

<p>Corresponding argument to the <b>uss add</b> command: <b>-realname</b>. Corresponding variable in the template file: $NAME. Many operating systems include a field for the full name in a user&#39;s entry in the local password file (<em>/etc/passwd</em> or equivalent), and this variable can be used to pass a value to be used in that field.</p>

<dt><a name="&#60;password&#62;"
>&#60;password&#62;</a></dt>

<dd>
<p>Specifies the user&#39;s initial password. Although the AFS commands that handle passwords accept strings of virtually unlimited length, it is best to use a password of eight characters or less, which is the maximum length that many applications and utilities accept. If not provided, this argument defaults to the string <code>changeme</code>.</p>

<p>Corresponding argument to the <b>uss add</b> command: <b>-pass</b>. Corresponding variable in the template file: none.</p>

<dt><a name="&#60;expires&#62;"
>&#60;expires&#62;</a></dt>

<dd>
<p>Sets the number of days after a user&#39;s password is changed that it remains valid. Provide an integer from the range <code>1</code> through <code>254</code> to specify the number of days until expiration, or the value <code>0</code> to indicate that the password never expires (the default).</p>

<p>When the password becomes invalid (expires), the user is unable to authenticate, but has 30 more days in which to issue the <b>kpasswd</b> command to change the password (after that, only an administrator can change it).</p>

<p>Corresponding argument to the <b>uss add</b> command: <b>-pwexpires</b>. Corresponding variable in the template file: $PWEXPIRES.</p>

<dt><a name="&#60;file_server&#62;"
>&#60;file_server&#62;</a></dt>

<dd>
<p>Names the file server machine on which to create the new user&#39;s volume. It is best to provide a fully-qualified hostname (for example, <code>fs1.abc.com</code>), but an abbreviated form is acceptable provided that the cell&#39;s naming service is available to resolve it at the time the volume is created.</p>

<p>Corresponding argument to the <b>uss add</b> command: <b>-server</b>. Corresponding variable in the template file: $SERVER.</p>

<dt><a name="&#60;partition&#62;"
>&#60;partition&#62;</a></dt>

<dd>
<p>Specifies the partition on which to create the user&#39;s volume; it must reside on the file server machine named in the &#60;file_server&#62; field. Identify the partition by its complete name (for example, <em>/vicepa</em>, or use one of the following abbreviations:</p>

<pre>   /vicepa     =     vicepa      =      a      =      0
   /vicepb     =     vicepb      =      b      =      1</pre>

<p>After <em>/vicepz</em> (for which the index is 25) comes</p>

<pre>   /vicepaa    =     vicepaa     =      aa     =      26
   /vicepab    =     vicepab     =      ab     =      27</pre>

<p>and so on through</p>

<pre>   /vicepiv    =     vicepiv     =      iv     =      255</pre>

<p>Corresponding argument to the <b>uss add</b> command: <b>-partition</b>. Corresponding variable in template: $PART.</p>

<dt><a name="&#60;mount_point&#62;"
>&#60;mount_point&#62;</a></dt>

<dd>
<p>Specifies the complete pathname for the user&#39;s home directory.</p>

<p>Corresponding argument to the <b>uss add</b> command: <b>-mount</b>.</p>

<p>Corresponding variable in template: $MTPT, but in the template file&#39;s <code>V</code> instruction only. Occurrences of the $MTPT variable in template instructions that follow the <code>V</code> instruction take their value from the <code>V</code> instruction&#39;s &#60;mount_point&#62; field. Thus the value of this command line argument becomes the value for the $MTPT variable in instructions that follow the <code>V</code> instruction only if the string $MTPT appears alone in the <code>V</code> instruction&#39;s &#60;mount_point&#62; field.</p>

<dt><a name="&#60;uid&#62;"
>&#60;uid&#62;</a></dt>

<dd>
<p>Specifies a positive integer other than <code>0</code> (zero) to assign as the user&#39;s AFS UID. If this argument is omitted, the Protection Server assigns an AFS UID that is one greater than the current value of the <code>max user id</code> counter (use the <b>pts listmax</b> command to display the counter). If including this argument, first use the <b>pts examine</b> command to verify that no existing account already has the desired AFS UID; if one does, the account-creation process terminates with an error.</p>

<p>Corresponding argument to the <b>uss add</b> command: <b>-uid</b>. Corresponding variable in template: $UID.</p>

<dt><a name="&#60;var1&#62;_through_&#60;var9&#62;"
>&#60;var1&#62; through &#60;var9&#62;</a></dt>

<dd>
<p>Specifies values for each of the number variables $1 through $9 that can appear in the template file. The number variables allow the administrator to provide values for variables other than the set defined by the <b>uss</b> command suite.</p>

<p>Corresponding argument to the <b>uss add</b> command: <b>-var</b>. Corresponding variables in template: $1 through $9.</p>

<p>If providing a value in any of the fields, then in every field that precedes it either provide an actual value or indicate an empty field by putting nothing between two colons. It is acceptable, but not necessary, to indicate empty fields by putting colons after the last field that contains an actual value.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_delete_Instruction_for_Deleting_an_Account"
>The delete Instruction for Deleting an Account</a></h2>

<p>The <code>delete</code> instruction deletes a user account from the system. Each instance in the bulk input file is equivalent in effect to a <b>uss delete</b> command issued on the command line. The order of the instruction&#39;s fields matches the order of arguments to the <b>uss delete</b> command:</p>

<pre>   delete &#60;username&#62;:&#60;mount_point&#62;[:( savevolume | delvolume )][:]</pre>

<p>where</p>

<dl>
<dt><a name="&#60;username&#62;"
>&#60;username&#62;</a></dt>

<dd>
<p>Names the entry to delete from the Protection and Authentication Databases.</p>

<dt><a name="&#60;mount_point&#62;"
>&#60;mount_point&#62;</a></dt>

<dd>
<p>Specifies the complete pathname to the user&#39;s home directory, which is deleted from the filespace. By default, the volume mounted there is also deleted from the file server machine where it resides, as is its record from the Volume Location Database (VLDB). To prevent deletion, include the <code>savevolume</code> string in the instruction&#39;s third field, or precede this <code>delete</code> instruction with a <code>savevolume</code> instruction. Partial pathnames are interpreted relative to the current working directory.</p>

<dt><a name="savevolume"
>savevolume</a></dt>

<dd>
<p>Retains the volume on its file server machine, and the corresponding entry in the VLDB. Provide this value or <code>delvolume</code> in the third field, or omit both values to treat the volume according to the prevailing default, which is set by a preceding <code>savevolume</code> or <code>delvolume</code> instruction in the bulk input file.</p>

<dt><a name="delvolume"
>delvolume</a></dt>

<dd>
<p>Removes the volume from its file server machine, and the corresponding entry from the VLDB. Provide this value or <code>savevolume</code> in the third field, or omit both values to treat the volume according to the prevailing default, which is set by a preceding <code>savevolume</code> or <code>delvolume</code> instruction in the bulk input file.</p>
</dd>
</dl>

<p>After the last argument provided, end the line with either a colon and carriage return or a carriage return alone.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_exec_Instruction_for_Executing_a_Command"
>The exec Instruction for Executing a Command</a></h2>

<p>The <code>exec</code> instruction executes the specified command, which can be a UNIX shell script or command, a program, or an AFS command. The <b>uss</b> command interpreter must have the necessary privileges in AFS and the local file system; it assumes the AFS and local identities of the issuer of the <b>uss bulk</b> command.</p>

<p>The instruction&#39;s syntax is as follows:</p>

<pre>   exec &#60;command&#62;</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_delvolume_and_savevolume_Instructions"
>The delvolume and savevolume Instructions</a></h2>

<p>The <code>savevolume</code> and <code>delvolume</code> instructions determine the default treatment of volumes referenced by the <code>delete</code> instructions that follow them in the bulk input file. Their syntax is as follows:</p>

<pre>   savevolume
   delvolume</pre>

<p>The <code>savevolume</code> instruction prevents the removal of the volume and VLDB entry for all <code>delete</code> instruction that follow it in the bulk input file, and the <code>delvolume</code> instruction removes the volume and VLDB entry for all subsequent <code>delete</code> instructions. Either setting persists until its opposite appears in the file, or until the end of the bulk file.</p>

<p>If neither line appears in the bulk input file, the default is to remove the volume and the VLDB entry; <code>delete</code> instructions that appear before the first <code>savevolume</code> instruction are also subject to this default. If a <code>delete</code> instruction&#39;s third field specifies either <code>savevolume</code> or <code>delvolume</code>, that setting overrides the default.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXAMPLES"
>EXAMPLES</a></h1>

<p>The following example add instruction creates an authentication-only account. The user&#39;s initial password is <code>changeme</code> (the default).</p>

<pre>   add anderson</pre>

<p>The following example add instructions refer to the indicated <code>V</code> instruction in a template file (which must appear on a single line in the template file).</p>

<pre>   add smith:John Smith:::fs1:a:::::marketing
   add jones:Pat Jones:::fs3:c:::::finance
   V user.$USER $SERVER.abc.com /vicep$PART 2000 \
       /afs/abc.com/usr/$3/$USER $UID $USER all</pre>

<p>The first add instruction creates an account called <code>smith</code> in the Protection and Authentication Databases, with an initial password <code>changeme</code> and a value for $UID provided by the Protection Server. The volume <code>user.smith</code> resides on partition <em>/vicepa</em> of file server machine <code>fs1.abc.com</code> and is mounted at <em>/afs/abc.com/usr/marketing/smith</em>. He owns his home directory and has all access permissions on its root directory&#39;s access control list (ACL). The account for <code>jones</code> is similar, except that the volume resides on partition <em>/vicepc</em> of file server machine <code>fs3.abc.com</code> and is mounted at <em>/afs/abc.com/usr/finance/jones</em>.</p>

<p>Notice that the fields corresponding to the volume mount point, UID, $1 variable, and $2 variable are empty (between <code>a</code> and <code>marketing</code> on the first example line), because their corresponding variables do not appear in the template file. The initial password field is also empty.</p>

<p>The following add instructions are equivalent in effect to the preceding example, but explicitly indicate empty fields for all of the number variables that don&#39;t have a value:</p>

<pre>   add smith:John Smith:::fs1:a:::::marketing::::::
   add jones:Pat Jones:::fs3:c:::::finance::::::</pre>

<p>The following example shows a complete bulk file containing a set of <code>delete</code> instructions combined with a <code>savevolume</code> instruction. Because the <code>delete</code> instruction for users <code>smith</code>, <code>pat</code>, and <code>rogers</code> appear before the <code>savevolume</code> instruction and the third field is blank in each, the corresponding home volumes are removed. The volume for user <code>terry</code> is retained because the default established by the <code>savevolume</code> instruction applies to it, but user <code>johnson</code>&#39;s volume is removed because the third field of her <code>delete</code> instruction overrides the current default.</p>

<pre>   delete smith:/afs/abc.com/usr/smith
   delete pat:/afs/abc.com/usr/pat
   delete rogers:/afs/abc.com/usr/rogers
   savevolume
   delete terry:/afs/abc.com/usr/terry
   delete johnson:/afs/abc.com/usr/johnson:delvolume</pre>

<p>The following example exec instruction appears between sets of <code>add</code> and <code>delete</code> instructions in a bulk input file. A message appears in the command shell where the <b>uss bulk</b> command is issued, to indicate when the additions are finished and the deletions beginning.</p>

<pre>   exec echo &#34;Additions completed; beginning deletions...&#34;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../5/uss.html" class="podlinkman"
>uss(5)</a>, <a href="../8/uss_add.html" class="podlinkpod"
>uss_add(8)</a>, <a href="../8/uss_bulk.html" class="podlinkpod"
>uss_bulk(8)</a>, <a href="../8/uss_delete.html" class="podlinkpod"
>uss_delete(8)</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>IBM Corporation 2000. &#60;http://www.ibm.com/&#62; All Rights Reserved.</p>

<p>This documentation is covered by the IBM Public License Version 1.0. It was converted from HTML to POD by software written by Chas Williams and Russ Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.</p>

<!-- end doc -->

</body></html>
