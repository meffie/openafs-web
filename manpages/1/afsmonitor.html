<html><head><title>afsmonitor</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="style" type="text/css" href="../style.css" media="all" >

</head>
<body class='pod'>
<!--
  generated by OpenAFS::HTML v1.1,
  using Pod::Simple::PullParser v2.02,
  under Perl v5.010000 at Sat Mar 29 18:17:40 2008 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to OpenAFS::HTML, and/or subclassing OpenAFS::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of OpenAFS::HTML for advice.
   See 'perldoc OpenAFS::HTML' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>afsmonitor - Monitors File Servers and Cache Managers</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>


<div class="synopsis">


<p><b>afsmonitor</b> [<b>initcmd</b>] [-config &#60;<i>configuration file</i>&#62;] [<b>-frequency</b>&#160;&#60;<i>poll&#160;frequency,&#160;in&#160;seconds</i>&#62;] [<b>-output</b>&#160;&#60;<i>storage&#160;file&#160;name</i>&#62;] [<b>-detailed</b>] [<b>-debug</b>&#160;&#60;<i>debug&#160;output&#160;file</i>&#62;] [<b>-fshosts</b>&#160;&#60;<i>list&#160;of&#160;file&#160;servers&#160;to&#160;monitor</i>&#62;+] [<b>-cmhosts</b>&#160;&#60;<i>list&#160;of&#160;cache&#160;managers&#160;to&#160;monitor</i>&#62;+] [<b>-buffers</b>&#160;&#60;<i>number&#160;of&#160;buffer&#160;slots</i>&#62;] [<b>-help</b>]</p>

<p><b>afsmonitor</b> [<b>i</b>] [-co &#60;<i>configuration file</i>&#62;] [<b>-fr</b>&#160;&#60;<i>poll&#160;frequency,&#160;in&#160;seconds</i>&#62;] [<b>-o</b>&#160;&#60;<i>storage&#160;file&#160;name</i>&#62;] [<b>-det</b>] [<b>-deb</b>&#160;&#60;<i>debug&#160;output&#160;file</i>&#62;] [<b>-fs</b>&#160;&#60;<i>list&#160;of&#160;file&#160;servers&#160;to&#160;monitor</i>&#62;+] [<b>-cm</b>&#160;&#60;<i>list&#160;of&#160;cache&#160;managers&#160;to&#160;monitor</i>&#62;+] [<b>-b</b>&#160;&#60;<i>number&#160;of&#160;buffer&#160;slots</i>&#62;] [<b>-h</b>]</p>


</div>


<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The afsmonitor command initializes a program that gathers and displays statistics about specified File Server and Cache Manager operations.
It allows the issuer to monitor,
from a single location,
a wide range of File Server and Cache Manager operations on any number of machines in both local and foreign cells.</p>

<p>There are 271 available File Server statistics and 571 available Cache Manager statistics,
listed in the appendix about <b>afsmonitor</b> statistics in the <i>IBM AFS Administration Guide</i>.
By default,
the command displays all of the relevant statistics for the file server machines named by the <b>-fshosts</b> argument and the client machines named by the <b>-cmhosts</b> argument.
To limit the display to only the statistics of interest,
list them in the configuration file specified by the <b>-config</b> argument.
In addition,
use the configuration file for the following purposes:</p>

<ul><li><p>To set threshold values for any monitored statistic.
When the value of a statistic exceeds the threshold,
the <b>afsmonitor</b> command displays it in reverse video.
There are no default threshold values.</p></li><li><p>To invoke a program or script automatically when a statistic exceeds its threshold.
The AFS distribution does not include any such scripts.</p></li><li><p>To list the file server and client machines to monitor,
instead of using the <b>-fshosts</b> and <b>-cmhosts</b> arguments.</p></li></ul>

<p>For a description of the configuration file,
see <a href="../5/afsmonitor.html" class="podlinkman"
>afsmonitor(5)</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CAUTIONS"
>CAUTIONS</a></h1>

<p>The following software must be accessible to a machine where the <b>afsmonitor</b> program is running:</p>

<ul><li><p>The AFS xstat libraries,
which the afsmonitor program uses to gather data.</p></li><li><p>The curses graphics package,
which most UNIX distributions provide as a standard utility.</p></li></ul>

<p>The <b>afsmonitor</b> screens format successfully both on so-called dumb terminals and in windowing systems that emulate terminals.
For the output to looks its best,
the display environment needs to support reverse video and cursor addressing.
Set the TERM environment variable to the correct terminal type,
or to a value that has characteristics similar to the actual terminal type.
The display window or terminal must be at least 80 columns wide and 12 lines long.</p>

<p>The <b>afsmonitor</b> program must run in the foreground,
and in its own separate,
dedicated window or terminal.
The window or terminal is unavailable for any other activity as long as the <b>afsmonitor</b> program is running.
Any number of instances of the <b>afsmonitor</b> program can run on a single machine,
as long as each instance runs in its own dedicated window or terminal.
Note that it can take up to three minutes to start an additional instance.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OPTIONS"
>OPTIONS</a></h1>

<dl>
<dt><a name="initcmd"
><b>initcmd</b></a></dt>

<dd>
<p>Accommodates the command&#39;s use of the AFS command parser,
and is optional.</p>

<dt><a name="-config_&#60;file&#62;"
><b>-config</b> &#60;<i>file</i>&#62;</a></dt>

<dd>
<p>Names the configuration file which lists the machines to monitor,
statistics to display,
and threshold values,
if any.
A partial pathname is interpreted relative to the current working directory.
Provide this argument if not providing the <b>-fshosts</b> argument,
<b>-cmhosts</b> argument,
or neither.
For instructions on creating this file,
see the preceding <b>DESCRIPTION</b> section,
and the section on the <b>afsmonitor</b> program in the <i>IBM AFS Administration Guide</i>.</p>

<dt><a name="-frequency_&#60;poll_frequency&#62;"
><b>-frequency</b> &#60;<i>poll frequency</i>&#62;</a></dt>

<dd>
<p>Specifies in seconds how often the afsmonitor program probes the File Servers and Cache Managers.
Valid values range from <code>1</code> to <code>86400</code> (which is 24 hours); the default value is <code>60</code>.
This frequency applies to both File Servers and Cache Managers,
but the <b>afsmonitor</b> program initiates the two types of probes,
and processes their results,
separately.
The actual interval between probes to a host is the probe frequency plus the time required for all hosts to respond.</p>

<dt><a name="-output_&#60;file&#62;"
><b>-output</b> &#60;<i>file</i>&#62;</a></dt>

<dd>
<p>Names the file to which the afsmonitor program writes all of the statistics that it collects.
By default,
no output file is created.
See the section on the <b>afsmonitor</b> command in the <i>IBM AFS Administration Guide</i> for information on this file.</p>

<dt><a name="-detailed"
><b>-detailed</b></a></dt>

<dd>
<p>Formats the information in the output file named by <b>-output</b> argument in a maximally readable format.
Provide the <b>-output</b> argument along with this one.</p>

<dt><a name="-fshosts_&#60;host&#62;+"
><b>-fshosts</b> &#60;<i>host</i>&#62;+</a></dt>

<dd>
<p>Names one or more machines from which to gather File Server statistics.
For each machine,
provide either a fully qualified host name,
or an unambiguous abbreviation (the ability to resolve an abbreviation depends on the state of the cell&#39;s name service at the time the command is issued).
This argument can be combined with the <b>-cmhosts</b> argument,
but not with the <b>-config</b> argument.</p>

<dt><a name="-cmhosts_&#60;host&#62;+"
><b>-cmhosts</b> &#60;<i>host</i>&#62;+</a></dt>

<dd>
<p>Names one or more machines from which to gather Cache Manager statistics.
For each machine,
provide either a fully qualified host name,
or an unambiguous abbreviation (the ability to resolve an abbreviation depends on the state of the cell&#39;s name service at the time the command is issued).
This argument can be combined with the <b>-fshosts</b> argument,
but not with the <b>-config</b> argument.</p>

<dt><a name="-buffers_&#60;slots&#62;"
><b>-buffers</b> &#60;<i>slots</i>&#62;</a></dt>

<dd>
<p>Is nonoperational and provided to accommodate potential future enhancements to the program.</p>

<dt><a name="-help"
><b>-help</b></a></dt>

<dd>
<p>Prints the online help for this command.
All other valid options are ignored.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OUTPUT"
>OUTPUT</a></h1>

<p>The afsmonitor program displays its data on three screens:</p>

<dl>
<dt><a name="System_Overview"
>System Overview</a></dt>

<dd>
<p>This screen appears automatically when the <b>afsmonitor</b> program initializes.
It summarizes separately for File Servers and Cache Managers the number of machines being monitored and how many of them have <i>alerts</i> (statistics that have exceeded their thresholds).
It then lists the hostname and number of alerts for each machine being monitored,
indicating if appropriate that a process failed to respond to the last probe.</p>

<dt><a name="File_Server"
>File Server</a></dt>

<dd>
<p>This screen displays File Server statistics for each file server machine being monitored.
It highlights statistics that have exceeded their thresholds,
and identifies machines that failed to respond to the last probe.</p>

<dt><a name="Cache_Managers"
>Cache Managers</a></dt>

<dd>
<p>This screen displays Cache Manager statistics for each client machine being monitored.
It highlights statistics that have exceeded their thresholds,
and identifies machines that failed to respond to the last probe.</p>
</dd>
</dl>

<p>Fields at the corners of every screen display the following information:</p>

<ul><li><p>In the top left corner,
the program name and version number.</p></li><li><p>In the top right corner,
the screen name,
current and total page numbers,
and current and total column numbers.
The page number (for example,
<code>p.
1 of 3</code>) indicates the index of the current page and the total number of (vertical) pages over which data is displayed.
The column number (for example,
<code>c.
1 of 235</code>) indicates the index of the current leftmost column and the total number of columns in which data appears.
(The symbol <code>&#62;&#62;&#62;</code> indicates that there is additional data to the right; the symbol <code>&#60;&#60;&#60;</code> indicates that there is additional data to the left.)</p></li><li><p>In the bottom left corner,
a list of the available commands.
Enter the first letter in the command name to run that command.
Only the currently possible options appear; for example,
if there is only one page of data,
the <code>next</code> and <code>prev</code> commands,
which scroll the screen up and down respectively,
do not appear.
For descriptions of the commands,
see the following section about navigating the display screens.</p></li><li><p>In the bottom right corner,
the <code>probes</code> field reports how many times the program has probed File Servers (<code>fs</code>),
Cache Managers (<code>cm</code>),
or both.
The counts for File Servers and Cache Managers can differ.
The <code>freq</code> field reports how often the program sends probes.</p></li></ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Navigating_the_afsmonitor_Display_Screens"
>Navigating the afsmonitor Display Screens</a></h2>

<p>As noted,
the lower left hand corner of every display screen displays the names of the commands currently available for moving to alternate screens,
which can either be a different type or display more statistics or machines of the current type.
To execute a command,
press the lowercase version of the first letter in its name.
Some commands also have an uppercase version that has a somewhat different effect,
as indicated in the following list.</p>

<dl>
<dt><a name="cm"
><code>cm</code></a></dt>

<dd>
<p>Switches to the <code>Cache Managers</code> screen.
Available only on the <code>System Overview</code> and <code>File Servers</code> screens.</p>

<dt><a name="fs"
><code>fs</code></a></dt>

<dd>
<p>Switches to the <code>File Servers</code> screen.
Available only on the <code>System Overview</code> and the <code>Cache Managers</code> screens.</p>

<dt><a name="left"
><code>left</code></a></dt>

<dd>
<p>Scrolls horizontally to the left,
to access the data columns situated to the left of the current set.
Available when the <code>&#60;&#60;&#60;</code> symbol appears at the top left of the screen.
Press uppercase <code>L</code> to scroll horizontally all the way to the left (to display the first set of data columns).</p>

<dt><a name="next"
><code>next</code></a></dt>

<dd>
<p>Scrolls down vertically to the next page of machine names.
Available when there are two or more pages of machines and the final page is not currently displayed.
Press uppercase <code>N</code> to scroll to the final page.</p>

<dt><a name="oview"
><code>oview</code></a></dt>

<dd>
<p>Switches to the <code>System Overview</code> screen.
Available only on the <code>Cache Managers</code> and <code>File Servers</code> screens.</p>

<dt><a name="prev"
><code>prev</code></a></dt>

<dd>
<p>Scrolls up vertically to the previous page of machine names.
Available when there are two or more pages of machines and the first page is not currently displayed.
Press uppercase <code>N</code> to scroll to the first page.</p>

<dt><a name="right"
><code>right</code></a></dt>

<dd>
<p>Scrolls horizontally to the right,
to access the data columns situated to the right of the current set.
This command is available when the <code>&#62;&#62;&#62;</code> symbol appears at the upper right of the screen.
Press uppercase <code>R</code> to scroll horizontally all the way to the right (to display the final set of data columns).</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_System_Overview_Screen"
>The System Overview Screen</a></h2>

<p>The <code>System Overview</code> screen appears automatically as the <b>afsmonitor</b> program initializes.
This screen displays the status of as many File Server and Cache Manager processes as can fit in the current window; scroll down to access additional information.</p>

<p>The information on this screen is split into File Server information on the left and Cache Manager information on the right.
The header for each grouping reports two pieces of information:</p>

<ul><li><p>The number of machines on which the program is monitoring the indicated process.</p></li><li><p>The number of alerts and the number of machines affected by them (an <i>alert</i> means that a statistic has exceeded its threshold or a process failed to respond to the last probe).</p></li></ul>

<p>A list of the machines being monitored follows.
If there are any alerts on a machine,
the number of them appears in square brackets to the left of the hostname.
If a process failed to respond to the last probe,
the letters <code>PF</code> (probe failure) appear in square brackets to the left of the hostname.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_File_Servers_Screen"
>The File Servers Screen</a></h2>

<p>The <code>File Servers</code> screen displays the values collected at the most recent probe for File Server statistics.</p>

<p>A summary line at the top of the screen (just below the standard program version and screen title blocks) specifies the number of monitored File Servers,
the number of alerts,
and the number of machines affected by the alerts.</p>

<p>The first column always displays the hostnames of the machines running the monitored File Servers.</p>

<p>To the right of the hostname column appear as many columns of statistics as can fit within the current width of the display screen or window; each column requires space for 10 characters.
The name of the statistic appears at the top of each column.
If the File Server on a machine did not respond to the most recent probe,
a pair of dashes (<code>--</code>) appears in each column.
If a value exceeds its configured threshold,
it is highlighted in reverse video.
If a value is too large to fit into the allotted column width,
it overflows into the next row in the same column.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_Cache_Managers_Screen"
>The Cache Managers Screen</a></h2>

<p>The <code>Cache Managers</code> screen displays the values collected at the most recent probe for Cache Manager statistics.</p>

<p>A summary line at the top of the screen (just below the standard program version and screen title blocks) specifies the number of monitored Cache Managers,
the number of alerts,
and the number of machines affected by the alerts.</p>

<p>The first column always displays the hostnames of the machines running the monitored Cache Managers.</p>

<p>To the right of the hostname column appear as many columns of statistics as can fit within the current width of the display screen or window; each column requires space for 10 characters.
The name of the statistic appears at the top of each column.
If the Cache Manager on a machine did not respond to the most recent probe,
a pair of dashes (<code>--</code>) appears in each column.
If a value exceeds its configured threshold,
it is highlighted in reverse video.
If a value is too large to fit into the allotted column width,
it overflows into the next row in the same column.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Writing_to_an_Output_File"
>Writing to an Output File</a></h2>

<p>Include the <b>-output</b> argument to name the file into which the <b>afsmonitor</b> program writes all of the statistics it collects.
The output file can be useful for tracking performance over long periods of time,
and enables the administrator to apply post-processing techniques that reveal system trends.
The AFS distribution does not include any post-processing programs.</p>

<p>The output file is in ASCII format and records the same information as the <code>File Server</code> and <code>Cache Manager</code> display screens.
Each line in the file uses the following format to record the time at which the <b>afsmonitor</b> program gathered the indicated statistic from the Cache Manager (<code>CM</code>) or File Server (<code>FS</code>) running on the machine called <i>host_name</i>.
If a probe failed,
the error code <code>-1</code> appears in the <i>statistic</i> field.</p>

<pre>   &#60;time&#62;  &#60;host_name&#62;  CM|FS   &#60;statistic&#62;</pre>

<p>If the administrator usually reviews the output file manually, rather than using it as input to an automated analysis program or script, including the <b>-detail</b> flag formats the data in a more easily readable form.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXAMPLES"
>EXAMPLES</a></h1>

<p>For examples of commands, display screens, and configuration files, see the section about the <b>afsmonitor</b> program in the <i>IBM AFS Administration Guide</i>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PRIVILEGE_REQUIRED"
>PRIVILEGE REQUIRED</a></h1>

<p>None</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../5/afsmonitor.html" class="podlinkman"
>afsmonitor(5)</a> <a href="../8/fstrace.html" class="podlinkman"
>fstrace(8)</a>, <a href="../1/scout.html" class="podlinkman"
>scout(1)</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>IBM Corporation 2000. &#60;http://www.ibm.com/&#62; All Rights Reserved.</p>

<p>This documentation is covered by the IBM Public License Version 1.0. It was converted from HTML to POD by software written by Chas Williams and Russ Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.</p>

<!-- end doc -->

</body></html>
