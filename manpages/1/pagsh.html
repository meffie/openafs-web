<html><head><title>pagsh</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="style" type="text/css" href="../style.css" media="all" >

</head>
<body class='pod'>
<!--
  generated by OpenAFS::HTML v1.1,
  using Pod::Simple::PullParser v2.02,
  under Perl v5.010000 at Fri Jun  6 16:42:55 2008 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to OpenAFS::HTML, and/or subclassing OpenAFS::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of OpenAFS::HTML for advice.
   See 'perldoc OpenAFS::HTML' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>pagsh - Creates a new PAG</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>


<div class="synopsis">


<p><b>pagsh</b></p>


</div>


<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The <b>pagsh</b> command creates a new command shell (owned by the issuer of the command) and associates a new <i>process authentication group</i> (PAG) with the shell and the user.
A PAG is a number guaranteed to identify the issuer of commands in the new shell uniquely to the local Cache Manager.
The PAG is used,
instead of the issuer&#39;s UNIX UID,
to identify the issuer in the credential structure that the Cache Manager creates to track each user.</p>

<p>Any tokens acquired subsequently (presumably for other cells) become associated with the PAG,
rather than with the user&#39;s UNIX UID.
This method for distinguishing users has two advantages.</p>

<ul><li><p>It means that processes spawned by the user inherit the PAG and so share the token; thus they gain access to AFS as the authenticated user.
In many environments,
for example,
printer and other daemons run under identities (such as the local superuser <code>root</code>) that the AFS server processes recognize only as <code>anonymous</code>.
Unless PAGs are used,
such daemons cannot access files in directories whose access control lists (ACLs) do not extend permissions to the system:anyuser group.</p></li><li><p>It closes a potential security loophole: UNIX allows anyone already logged in as the local superuser <code>root</code> on a machine to assume any other identity by issuing the UNIX <b>su</b> command.
If the credential structure is identified by a UNIX UID rather than a PAG,
then the local superuser <code>root</code> can assume a UNIX UID and use any tokens associated with that UID.
Use of a PAG as an identifier eliminates that possibility.</p></li></ul>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CAUTIONS"
>CAUTIONS</a></h1>

<p>Each PAG created uses two of the memory slots that the kernel uses to record the UNIX groups associated with a user.
If none of these slots are available,
the <b>pagsh</b> command fails.
This is not a problem with most operating systems,
which make at least 16 slots available per user.</p>

<p>In cells that do not use an AFS-modified login utility,
use this command to obtain a PAG before issuing the <b>klog</b> command (or include the <b>-setpag</b> argument to the <b>klog</b> command).
If a PAG is not acquired,
the Cache Manager stores the token in a credential structure identified by local UID rather than PAG.
This creates the potential security exposure described in <a href="./DESCRIPTION.html" class="podlinkpod"
>DESCRIPTION</a>.</p>

<p>If users of NFS client machines for which AFS is supported are to issue this command as part of authenticating with AFS,
do not use the <b>fs exportafs</b> command&#39;s <b>-uidcheck on</b> argument to enable UID checking on NFS/AFS Translator machines.
Enabling UID checking prevents this command from succeeding.
See <a href="../1/klog.html" class="podlinkman"
>klog(1)</a>.</p>

<p>If UID checking is not enabled on Translator machines,
then by default it is possible to issue this command on a properly configured NFS client machine that is accessing AFS via the NFS/AFS Translator,
assuming that the NFS client machine is a supported system type.
The <b>pagsh</b> binary accessed by the NFS client must be owned by,
and grant setuid privilege to,
the local superuser <code>root</code>.
The complete set of mode bits must be <code>-rwsr-xr-x</code>.
This is not a requirement when the command is issued on AFS client machines.</p>

<p>However,
if the translator machine&#39;s administrator has enabled UID checking by including the <b>-uidcheck on</b> argument to the <b>fs exportafs</b> command,
the command fails with an error message similar to the following:</p>

<pre>   Warning: Remote setpag to &#60;translator_machine&#62; has failed (err=8). . .
   setpag: Exec format error</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXAMPLES"
>EXAMPLES</a></h1>

<p>In the following example, the issuer invokes the C shell instead of the default Bourne shell:</p>

<pre>   # pagsh -c /bin/csh</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PRIVILEGE_REQUIRED"
>PRIVILEGE REQUIRED</a></h1>

<p>None</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../1/fs_exportafs.html" class="podlinkpod"
>fs_exportafs(1)</a>, <a href="../1/klog.html" class="podlinkman"
>klog(1)</a>, <a href="../1/tokens.html" class="podlinkman"
>tokens(1)</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>IBM Corporation 2000. &#60;http://www.ibm.com/&#62; All Rights Reserved.</p>

<p>This documentation is covered by the IBM Public License Version 1.0. It was converted from HTML to POD by software written by Chas Williams and Russ Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.</p>

<!-- end doc -->

</body></html>
