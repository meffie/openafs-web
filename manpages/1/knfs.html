<html><head><title>knfs</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="style" type="text/css" href="../style.css" media="all" >

</head>
<body class='pod'>
<!--
  generated by OpenAFS::HTML v1.1,
  using Pod::Simple::PullParser v2.02,
  under Perl v5.010000 at Fri Jun 27 16:25:58 2008 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to OpenAFS::HTML, and/or subclassing OpenAFS::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of OpenAFS::HTML for advice.
   See 'perldoc OpenAFS::HTML' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>knfs - Establishes authenticated access via the NFS/AFS Translator</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>


<div class="synopsis">


<p><b>knfs</b> <b>-host</b>&#160;&#60;<i>host&#160;name</i>&#62; [<b>-id</b>&#160;&#60;<i>user&#160;ID&#160;(decimal)</i>&#62;] [<b>-sysname</b>&#160;&#60;<i>host&#39;s&#160;&#39;@sys&#39;&#160;value</i>&#62;] [<b>-unlog</b>] [<b>-tokens</b>] [<b>-help</b>]</p>

<p><b>knfs</b> <b>-ho</b>&#160;&#60;<i>host&#160;name</i>&#62; [<b>-i</b>&#160;&#60;<i>user&#160;ID&#160;(decimal)</i>&#62;] [<b>-s</b>&#160;&#60;<i>host&#39;s&#160;&#39;@sys&#39;&#160;value</i>&#62;] [<b>-u</b>] [<b>-t</b>] [<b>-he</b>]</p>


</div>


<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The <b>knfs</b> command creates an AFS credential structure on the local machine,
identifying it by a process authentication group (PAG) number associated with the NFS client machine named by the <b>-hostname</b> argument and by default with a local UID on the NFS client machine that matches the issuer&#39;s local UID on the local machine.
It places in the credential structure the AFS tokens that the issuer has previously obtained (by logging onto the local machine if an AFS-modified login utility is installed,
by issuing the <b>klog</b> command,
or both).
To associate the credential structure with an NFS UID that does not match the issuer&#39;s local UID,
use the <b>-id</b> argument.</p>

<p>Issue this command only on the NFS(R)/AFS translator machine that is serving the NFS client machine,
after obtaining AFS tokens on the translator machine for every cell to which authenticated access is required.
The Cache Manager on the translator machine uses the tokens to obtain authenticated AFS access for the designated user working on the NFS client machine.
This command is not effective if issued on an NFS client machine.</p>

<p>To enable the user on the NFS client machine to issue AFS commands,
use the <b>-sysname</b> argument to specify the NFS client machine&#39;s system type,
which can differ from the translator machine&#39;s.
The NFS client machine must be a system type for which AFS is supported.</p>

<p>The <b>-unlog</b> flag discards the tokens in the credential structure,
but does not destroy the credential structure itself.
The Cache Manager on the translator machine retains the credential structure until the next reboot,
and uses it each time the issuer accesses AFS through the translator machine.
The credential structure only has tokens in it if the user reissues the <b>knfs</b> command on the translator machine each time the user logs into the NFS client machine.</p>

<p>To display the tokens associated with the designated user on the NFS client machine,
include the <b>-tokens</b> flag.</p>

<p>Users working on NFS client machines of system types for which AFS binaries are available can use the <b>klog</b> command rather than the <b>knfs</b> command.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CAUTIONS"
>CAUTIONS</a></h1>

<p>If the translator machine&#39;s administrator has enabled UID checking by issuing the <b>fs exportafs</b> command with the <b>-uidcheck on</b> argument,
it is not possible to use the <b>-id</b> argument to assign the tokens to an NFS UID that differs from the issuer&#39;s local UID.
In this case,
there is no point in including the <b>-id</b> argument,
because the only acceptable value (the issuer&#39;s local UID) is the value used when the <b>-id</b> argument is omitted.
Requiring matching UIDs is effective only when users have the same local UID on the translator machine as on NFS client machines.
In that case,
it guarantees that users assign their tokens only to their own NFS sessions.</p>

<p>This command does not make it possible for users working on non-supported system types to issue AFS commands.
This is possible only on NFS clients of a system type for which AFS is available.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OPTIONS"
>OPTIONS</a></h1>

<dl>
<dt><a name="-host_&#60;host_name&#62;"
><b>-host</b> &#60;<i>host name</i>&#62;</a></dt>

<dd>
<p>Names the NFS client machine on which the issuer is to work.
Providing a fully-qualified hostname is best,
but abbreviated forms are possibly acceptable depending on the state of the cell&#39;s name server at the time the command is issued.</p>

<dt><a name="-id_&#60;user_ID_(decimal)&#62;"
><b>-id</b> &#60;<i>user ID (decimal)</i>&#62;</a></dt>

<dd>
<p>Specifies the local UID on the NFS client to which to assign the tokens.
The NFS client identifies file requests by the NFS UID,
so creating the association enables the Cache Manager on the translator machine to use the appropriate tokens when filling the requests.
If this argument is omitted,
the command interpreter uses an NFS UID that matches the issuer&#39;s local UID on the translator machine (as returned by the getuid() function).</p>

<dt><a name="-sysname_&#60;host&#39;s_&#39;@sys&#39;_value&#62;"
><b>-sysname</b> &#60;<i>host&#39;s &#39;@sys&#39; value</i>&#62;</a></dt>

<dd>
<p>Specifies the value that the local (translator) machine&#39;s remote executor daemon substitutes for the <i>@sys</i> variable in pathnames when executing AFS commands issued on the NFS client machine (which must be a supported system type).
If the NFS user&#39;s PATH environment variable uses the <i>@sys</i> variable in the pathnames for directories that house AFS binaries (as recommended),
then setting this argument enables NFS users to issue AFS commands by leading the remote executor daemon to access the AFS binaries appropriate to the NFS client machine even if its system type differs from the translator machine&#39;s.</p>

<dt><a name="-unlog"
><b>-unlog</b></a></dt>

<dd>
<p>Discards the tokens stored in the credential structure identified by the PAG associated with the <b>-host</b> argument and,
optionally,
the <b>-id</b> argument.</p>

<dt><a name="-tokens"
><b>-tokens</b></a></dt>

<dd>
<p>Displays the AFS tokens assigned to the designated user on the indicated NFS client machine.</p>

<dt><a name="-help"
><b>-help</b></a></dt>

<dd>
<p>Prints the online help for this command.
All other valid options are ignored.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OUTPUT"
>OUTPUT</a></h1>

<p>The following error message indicates that UID checking is enabled on the translator machine and that the value provided for the <b>-id</b> argument differs from the issuer&#39;s local UID.</p>

<pre>   knfs: Translator in &#39;passwd sync&#39; mode; remote uid must be the same as
   local uid</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXAMPLES"
>EXAMPLES</a></h1>

<p>The following example illustrates a typical use of this command. The issuer <code>smith</code> is working on the machine <code>nfscli1.abc.com</code> and has user ID <code>1020</code> on that machine. The translator machine <code>tx4.abc.com</code> uses an AFS-modified login utility, so <code>smith</code> obtains tokens for the ABC Corporation cell automatically upon login via the <b>telnet</b> program. She then issues the <b>klog</b> command to obtain tokens as <code>admin</code> in the ABC Corporation&#39;s test cell, <code>test.abc.com</code>, and the <b>knfs</b> command to associate both tokens with the credential structure identified by machine name <code>nfs-cli1</code> and user ID <code>1020</code>. She breaks the connection to <code>tx4</code> and works on <code>nfscli1</code>.</p>

<pre>   % telnet tx4.abc.com
   . . .
   login: smith
   Password:
   AFS(R) login

   % klog admin -cell test.abc.com
   Password:

   % knfs nfscli1.abc.com 1020

   % exit</pre>

<p>The following example shows user smith again connecting to the machine <code>tx4</code> via the <b>telnet</b> program and discarding the tokens.</p>

<pre>   % telnet translator4.abc.com
   . . .
   login: smith
   Password:
   AFS(R) login

   % knfs nfscli1.abc.com 1020 -unlog

   % exit</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PRIVILEGE_REQUIRED"
>PRIVILEGE REQUIRED</a></h1>

<p>None</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../1/klog.html" class="podlinkman"
>klog(1)</a>, <a href="../1/pagsh.html" class="podlinkman"
>pagsh(1)</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>IBM Corporation 2000. &#60;http://www.ibm.com/&#62; All Rights Reserved.</p>

<p>This documentation is covered by the IBM Public License Version 1.0. It was converted from HTML to POD by software written by Chas Williams and Russ Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.</p>

<!-- end doc -->

</body></html>
