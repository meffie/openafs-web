<html><head><title>klog</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="style" type="text/css" href="../style.css" media="all" >

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.03,
  using Pod::Simple::PullParser v2.02,
  under Perl v5.010000 at Tue Nov 11 07:45:44 2008 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="indexlink"><a href="../index.html">Back to Index</a></p>
<a name='___top' class='dummyTopAnchor' ></a>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>klog - Authenticates with the Authentication Server</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>


<div class="synopsis">


<p><b>klog</b> [<b>-x</b>] [<b>-principal</b>&#160;&#60;<i>user&#160;name</i>&#62;] [-password &#60;<i>user&#39;s password</i>&#62;] [<b>-cell</b>&#160;&#60;<i>cell&#160;name</i>&#62;] [<b>-servers</b>&#160;&#60;<i>explicit&#160;list&#160;of&#160;servers</i>&#62;+] [<b>-pipe</b>] [<b>-silent</b>] [<b>-lifetime</b>&#160;&#60;<i>ticket&#160;lifetime&#160;in&#160;hh[:mm[:ss]]</i>&#62;] [<b>-setpag</b>] [<b>-tmp</b>] [<b>-help</b>]</p>

<p><b>klog</b> [<b>-x</b>] [<b>-pr</b>&#160;&#60;<i>user&#160;name</i>&#62;] [<b>-pa</b>&#160;&#60;<i>user&#39;s&#160;password</i>&#62;] [<b>-c</b>&#160;&#60;<i>cell&#160;name</i>&#62;] [<b>-s</b>&#160;&#60;<i>explicit&#160;list&#160;of&#160;servers</i>&#62;+] [<b>-pi</b>] [<b>-si</b>] [<b>-l</b>&#160;&#60;<i>ticket&#160;lifetime&#160;in&#160;hh[:mm[:ss]]</i>&#62;] [<b>-se</b>] [<b>-t</b>] [<b>-h</b>]</p>


</div>


<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The <b>klog</b> command obtains an AFS token from the Authentication Server.
The Cache Manager on the local machine stores the token in a credential structure in kernel memory and uses it when obtaining authenticated access to the AFS filespace.
This command does not affect the issuer&#39;s identity (UNIX UID) in the local file system.</p>

<p>By default,
the command interpreter obtains a token for the AFS user name that matches the issuer&#39;s identity in the local file system.
To specify an alternate user,
include the <b>-principal</b> argument.
The user named by the <b>-principal</b> argument does not have to appear in the local password file (the <em>/etc/passwd</em> file or equivalent).</p>

<p>By default,
the command interpreter obtains a token for the local cell,
as defined by the AFSCELL environment variable set in the command shell or by the <em>/usr/vice/etc/ThisCell</em> file on the local machine.
To specify an alternate cell,
include the <b>-cell</b> argument.
The command interpreter contacts an Authentication Server chosen at random from the cell&#39;s entry in the local <em>/usr/afs/etc/CellServDB</em> file,
unless the <b>-servers</b> argument is used to name one or more database server machines.</p>

<p>A user can have tokens in multiple cells simultaneously,
but only one token per cell per connection to the client machine.
If the user&#39;s credential structure already contains a token for the requested cell,
the token resulting from this command replaces it.</p>

<p>Sites that employ Kerberos authentication instead of the AFS Authentication Server should normally use the combination of <b>kinit</b> and <b>aklog</b> instead of <b>klog</b>.</p>

<p>Sites using Kerberos v4 authentication (perhaps with the AFS Authentication Server) must use the Kerberos version of this command,
<b>klog.krb</b>,
on all client machines.
It automatically places the issuer&#39;s Kerberos tickets in the file named by the KRBTKFILE environment variable,
which the <b>pagsh.krb</b> command defines automatically as <em>/tmp/tktp<i>X</i></em> where <i>X</i> is the number of the user&#39;s PAG.</p>

<p>The lifetime of the token resulting from this command is the smallest of the following.</p>

<ul><li><p>The lifetime specified by the issuer with the <b>-lifetime</b> argument.
If the issuer does not include this argument,
the value defaults to 720 hours (30 days).</p></li><li><p>The maximum ticket lifetime recorded for the afs entry in the Authentication Database.
The default is 100 hours.</p></li><li><p>The maximum ticket lifetime recorded in the specified user&#39;s Authentication Database entry.
The default is 25 hours for user entries created by an Authentication Server running AFS 3.1 or later.</p></li><li><p>The maximum ticket lifetime recorded in the krbtgt.<i>CELLNAME</i> entry in the Authentication Database; this entry corresponds to the ticket-granting ticket used internally in generating the token.
The default is 720 hours (30 days).</p></li></ul>

<p>The output from the kas examine command displays an Authentication Database entry&#39;s maximum ticket lifetime as <code>Max ticket lifetime</code>.
Administrators can display any entry,
and users can display their own entries.</p>

<p>If none of the defaults have been changed,
the token lifetime is 25 hours for user accounts created by an Authentication Server running AFS 3.1 or higher.
The maximum lifetime for any token is 720 hours (30 days),
and the minimum is 5 minutes.</p>

<p>Between the minimum and maximum values,
the Authentication Server uses a defined set of values,
according to the following rules.
Requested lifetimes between 5 minutes and 10 hours 40 minutes are granted at 5 minute intervals,
rounding up.
For example,
if the issuer requests a lifetime of 12 minutes,
the token&#39;s actual lifetime is 15 minutes.</p>

<p>For token lifetimes greater than 10 hours 40 minutes,
consult the following table,
which presents all the possible times in units of <i>hours</i><b>:</b><i>minutes</i><b>:</b><i>seconds</i>.
The number in parentheses is an approximation of the corresponding time in days and hours (as indicated by the <code>d</code> and <code>h</code> letters).
For example,
<code>282:22:17</code> means 282 hours,
22 minutes,
and 17 seconds,
which translates to approximately 11 days and 18 hours (<code>11d 18h</code>).
The Authentication Server rounds up a requested lifetime to the next highest possible lifetime.</p>

<pre>   11:24:15 (0d 11h)    46:26:01 (1d 22h)  189:03:38 (7d 21h)
   12:11:34 (0d 12h)    49:38:40 (2d 01h)  202:08:00 (8d 10h)
   13:02:09 (0d 13h)    53:04:37 (2d 05h)  216:06:35 (9d 00h)
   13:56:14 (0d 13h)    56:44:49 (2d 08h)  231:03:09 (9d 15h)
   14:54:03 (0d 14h)    60:40:15 (2d 12h)  247:01:43 (10d 07h)
   15:55:52 (0d 15h)    64:51:57 (2d 16h)  264:06:34 (11d 00h)
   17:01:58 (0d 17h)    69:21:04 (2d 21h)  282:22:17 (11d 18h)
   18:12:38 (0d 18h)    74:08:46 (3d 02h)  301:53:45 (12d 13h)
   19:28:11 (0d 19h)    79:16:23 (3d 07h)  322:46:13 (13d 10h)
   20:48:57 (0d 20h)    84:45:16 (3d 12h)  345:05:18 (14d 09h)
   22:15:19 (0d 22h)    90:36:53 (3d 18h)  368:56:58 (15d 08h)
   23:47:38 (0d 23h)    96:52:49 (4d 00h)  394:27:37 (16d 10h)
   25:26:21 (1d 01h)   103:34:45 (4d 07h)  421:44:07 (17d 13h)
   27:11:54 (1d 03h)   110:44:28 (4d 14h)  450:53:46 (18d 18h)
   29:04:44 (1d 05h)   118:23:54 (4d 22h)  482:04:24 (20d 02h)
   31:05:22 (1d 07h)   126:35:05 (5d 06h)  515:24:22 (21d 11h)
   33:14:21 (1d 09h)   135:20:15 (5d 15h)  551:02:38 (22d 23h)
   35:32:15 (1d 11h)   144:41:44 (6d 00h)  589:08:45 (24d 13h)
   37:59:41 (1d 13h)   154:42:01 (6d 10h)  629:52:56 (26d 05h)
   40:37:19 (1d 16h)   165:23:50 (6d 21h)  673:26:07 (28d 01h)
   43:25:50 (1d 19h)   176:50:01 (7d 08h)</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CAUTIONS"
>CAUTIONS</a></h1>

<p>By default, this command does not create a new process authentication group (PAG); see the description of the <b>pagsh</b> command to learn about PAGs. If a cell does not use an AFS-modified login utility, users must include <b>-setpag</b> option to this command, or issue the <b>pagsh</b> command before this one, to have their tokens stored in a credential structure that is identified by PAG rather than by local UID.</p>

<p>When a credential structure is identified by local UID, the potential security exposure is that the local superuser <code>root</code> can use the UNIX <b>su</b> command to assume any other identity and automatically inherit the tokens associated with that UID. Identifying the credential structure by PAG eliminates this exposure.</p>

<p>If the <b>-password</b> argument is used, the specified password cannot begin with a hyphen, because it is interpreted as another option name. Use of the <b>-password</b> argument is not recommended in any case.</p>

<p>By default, it is possible to issue this command on a properly configured NFS client machine that is accessing AFS via the NFS/AFS Translator, assuming that the NFS client machine is a supported system type. However, if the translator machine&#39;s administrator has enabled UID checking by including the <b>-uidcheck on</b> argument to the <b>fs exportafs</b> command, the command fails with an error message similar to the following:</p>

<pre>   Warning: Remote pioctl to &#60;translator_machine&#62; has failed (err=8). . .
   Unable to authenticate to AFS because a pioctl failed.</pre>

<p>Enabling UID checking means that the credential structure in which tokens are stored on the translator machine must be identified by a UID that matches the local UID of the process that is placing the tokens in the credential structure. After the <b>klog</b> command interpreter obtains the token on the NFS client, it passes it to the remote executor daemon on the translator machine, which makes the system call that stores the token in a credential structure on the translator machine. The remote executor generally runs as the local superuser <code>root</code>, so in most cases its local UID (normally zero) does not match the local UID of the user who issued the <b>klog</b> command on the NFS client machine.</p>

<p>Issuing the <b>klog</b> command on an NFS client machine creates a security exposure: the command interpreter passes the token across the network to the remote executor daemon in clear text mode.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OPTIONS"
>OPTIONS</a></h1>

<dl>
<dt><a name="-x"
><b>-x</b></a></dt>

<dd>
<p>Appears only for backwards compatibility. Its former function is now the default behavior of this command.</p>

<dt><a name="-principal_&#60;user_name&#62;"
><b>-principal</b> &#60;<i>user name</i>&#62;</a></dt>

<dd>
<p>Specifies the user name to authenticate. If this argument is omitted, the Authentication Server attempts to authenticate the user logged into the local system.</p>

<dt><a name="-password_&#60;user&#39;s_password&#62;"
><b>-password</b> &#60;<i>user&#39;s password</i>&#62;</a></dt>

<dd>
<p>Specifies the issuer&#39;s password (or that of the alternate user identified by the <b>-principal</b> argument). Omit this argument to have the command interpreter prompt for the password, in which case it does not echo visibly in the command shell.</p>

<dt><a name="-cell_&#60;cell_name&#62;"
><b>-cell</b> &#60;<i>cell name</i>&#62;</a></dt>

<dd>
<p>Specifies the cell for which to obtain a token. The command is directed to that cell&#39;s Authentication Servers. During a single login session on a given machine, a user can be authenticated in multiple cells simultaneously, but can have only one token at a time for each of them (that is, can only authenticate under one identity per cell per session on a machine). It is acceptable to abbreviate the cell name to the shortest form that distinguishes it from the other cells listed in the <em>/usr/vice/etc/CellServDB</em> file on the client machine on which the command is issued.</p>

<p>If this argument is omitted, the command is executed in the local cell, as defined</p>

<ul><li><p>First, by the value of the environment variable AFSCELL.</p></li><li><p>Second, in the <em>/usr/vice/etc/ThisCell</em> file on the client machine on which the command is issued.</p></li></ul>

<dt><a name="-servers_&#60;explicit_list_of_servers&#62;+"
><b>-servers</b> &#60;<i>explicit list of servers</i>&#62;+</a></dt>

<dd>
<p>Establishes a connection with the Authentication Server running on each specified database server machine. The command interpreter then chooses one of these at random to execute the command. It is best to provide fully-qualified hostnames, but abbreviated forms are possibly acceptable depending on the state of the cell&#39;s name server at the time the command is issued. This option is useful for testing specific servers if problems are encountered.</p>

<p>If this argument is omitted, the command interpreter establishes a connection with each machine listed for the indicated cell in the local copy of the <em>/usr/vice/etc/CellServDB</em> file, and then chooses one of them at random for command execution.</p>

<dt><a name="-pipe"
><b>-pipe</b></a></dt>

<dd>
<p>Suppresses all output to the standard output stream, including prompts and error messages. The <b>klog</b> command interpreter expects to receive the password from the standard input stream. Do not use this argument; it is designed for use by application programs rather than human users.</p>

<dt><a name="-silent"
><b>-silent</b></a></dt>

<dd>
<p>Suppresses some of the trace messages that the klog command produces on the standard output stream by default. It still reports on major problems encountered.</p>

<dt><a name="-lifetime_&#60;ticket_lifetime"
><b>-lifetime</b> &#60;<i>ticket lifetime</i></a></dt>

<dd>
<p>Requests a specific lifetime for the token. Provide a number of hours and optionally minutes and seconds in the format <i>hh</i>[<b>:</b><i>mm</i>[<b>:</b><i>ss</i>]]. The value is used in calculating the token lifetime as described in <a href="./DESCRIPTION.html" class="podlinkpod"
>DESCRIPTION</a>.</p>

<dt><a name="-setpag"
><b>-setpag</b></a></dt>

<dd>
<p>Creates a process authentication group (PAG) prior to requesting authentication. The token is associated with the newly created PAG.</p>

<dt><a name="-tmp"
><b>-tmp</b></a></dt>

<dd>
<p>Creates a Kerberos-style ticket file in the <em>/tmp</em> directory of the local machine. The file is called <em>tkt.<i>AFS_UID</i></em> where <i>AFS_UID</i> is the AFS UID of the issuer.</p>

<dt><a name="-help"
><b>-help</b></a></dt>

<dd>
<p>Prints the online help for this command. All other valid options are ignored.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OUTPUT"
>OUTPUT</a></h1>

<p>The following message indicates that the limit on consecutive authentication failures has been exceeded. An administrator can use the <b>kas unlock</b> command to unlock the account, or the issuer can wait until the lockout time for the account has passed. (The time is set with the <b>-locktime</b> argument to the <b>kas setfields</b> command and displayed in the output from the <b>kas examine</b> command).</p>

<pre>   Unable to authenticate to AFS because ID is locked - see your system admin</pre>

<p>If the <b>-tmp</b> flag is included, the following message confirms that a Kerberos-style ticket file was created:</p>

<pre>   Wrote ticket file to /tmp</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXAMPLES"
>EXAMPLES</a></h1>

<p>Most often, this command is issued without arguments. The appropriate password is for the person currently logged into the local system. The ticket&#39;s lifetime is calculated as described in <a href="./DESCRIPTION.html" class="podlinkpod"
>DESCRIPTION</a> (if no defaults have been changed, it is 25 hours for a user whose Authentication Database entry was created in AFS 3.1 or later).</p>

<pre>   % klog
   Password:</pre>

<p>The following example authenticates the user as admin in the ABC Corporation&#39;s test cell:</p>

<pre>   % klog -principal admin -cell test.abc.com
   Password:</pre>

<p>In the following, the issuer requests a ticket lifetime of 104 hours 30 minutes (4 days 8 hours 30 minutes). Presuming that this lifetime is allowed by the maximum ticket lifetimes and other factors described in <a href="./DESCRIPTION.html" class="podlinkpod"
>DESCRIPTION</a>, the token&#39;s lifetime is 110:44:28, which is the next largest possible value.</p>

<pre>   % klog -lifetime 104:30
   Password:</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PRIVILEGE_REQUIRED"
>PRIVILEGE REQUIRED</a></h1>

<p>None</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../1/fs_exportafs.html" class="podlinkpod"
>fs_exportafs(1)</a>, <a href="../8/kas_examine.html" class="podlinkpod"
>kas_examine(8)</a>, <a href="../8/kas_setfields.html" class="podlinkpod"
>kas_setfields(8)</a>, <a href="../8/kas_unlock.html" class="podlinkpod"
>kas_unlock(8)</a>, <a href="../8/kaserver.html" class="podlinkman"
>kaserver(8)</a>, <a href="../1/pagsh.html" class="podlinkman"
>pagsh(1)</a>, <a href="../1/tokens.html" class="podlinkman"
>tokens(1)</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>IBM Corporation 2000. &#60;http://www.ibm.com/&#62; All Rights Reserved.</p>

<p>This documentation is covered by the IBM Public License Version 1.0. It was converted from HTML to POD by software written by Chas Williams and Russ Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.</p>
<p class="indexlink"><a href="../index.html">Back to Index</a></p>

<!-- end doc -->

</body></html>
