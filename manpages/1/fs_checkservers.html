<html><head><title>fs_checkservers</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="style" type="text/css" href="../style.css" media="all" >

</head>
<body class='pod'>
<!--
  generated by OpenAFS::HTML v1.1,
  using Pod::Simple::PullParser v2.02,
  under Perl v5.010000 at Mon Jul 14 01:56:33 2008 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to OpenAFS::HTML, and/or subclassing OpenAFS::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of OpenAFS::HTML for advice.
   See 'perldoc OpenAFS::HTML' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>fs_checkservers - Displays the status of server machines</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>


<div class="synopsis">


<p><b>fs checkservers</b> [<b>-cell</b>&#160;&#60;<i>cell&#160;to&#160;check</i>&#62;] [<b>-all</b>] [<b>-fast</b>] [<b>-interval</b>&#160;&#60;<i>seconds&#160;between&#160;probes</i>&#62;] [<b>-help</b>]</p>

<p><b>fs checks</b> [<b>-c</b>&#160;&#60;<i>cell&#160;to&#160;check</i>&#62;] [<b>-a</b>] [<b>-f</b>] [<b>-i</b>&#160;&#60;<i>seconds&#160;between&#160;probes</i>&#62;] [<b>-h</b>]</p>


</div>


<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The <b>fs checkservers</b> command reports whether certain AFS server machines are accessible from the local client machine.
The machines belong to one of two classes,
and the Cache Manager maintains a list of them in kernel memory:</p>

<ul><li><p>The database server machines in every cell listed in the local <em>/usr/vice/etc/CellServDB file</em>,
plus any machines added to the memory list by the <b>fs newcell</b> command since the last reboot.</p></li><li><p>All file server machines the Cache Manager has recently contacted,
and which it probably needs to contact again soon.
In most cases,
the Cache Manager holds a callback on a file or volume fetched from the machine.</p></li></ul>

<p>If the Cache Manager is unable to contact the vlserver process on a database server machine or the <b>fileserver</b> process on a file server machine,
it marks the machine as inaccessible.
(Actually,
if a file server machine is multihomed,
the Cache Manager attempts to contact all of the machine&#39;s interfaces,
and only marks the machine as down if the <b>fileserver</b> fails to reply via any of them.) The Cache Manager then periodically (by default,
every three minutes) sends a probe to each marked machine,
to see if it is still inaccessible.
If a previously inaccessible machine responds,
the Cache Manager marks it as accessible and no longer sends the periodic probes to it.</p>

<p>The <b>fs checkservers</b> command updates the list of inaccessible machines by having the Cache Manager probe a specified set of them:</p>

<ul><li><p>By default,
only machines that are marked inaccessible and belong to the local cell (the cell listed in the local <em>/usr/vice/etc/ThisCell</em> file).</p></li><li><p>If the <b>-cell</b> argument is included,
only machines that are marked inaccessible and belong to the specified cell.</p></li><li><p>If the <b>-all</b> flag is included,
all machines marked inaccessible.</p></li></ul>

<p>If the <b>-fast</b> flag is included,
the Cache Manager does not probe any machines,
but instead reports the results of the most recent previous probe.</p>

<p>To set the interval between probes rather than produce a list of inaccessible machines,
use the <b>-interval</b> argument.
The non-default setting persists until the machine reboots; to preserve it across reboots,
put the appropriate <b>fs checkservers</b> command in the machine&#39;s AFS initialization files.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CAUTIONS"
>CAUTIONS</a></h1>

<p>The command can take quite a while to complete,
if a number of machines do not respond to the Cache Manager&#39;s probe.
The Cache Manager probes machines sequentially and waits a standard timeout period before marking the machine as unresponsive,
to allow for slow network communication.
To make the command shell prompt return quickly,
put the command in the background.
It is harmless to interrupt the command by typing Ctrl-C or another interrupt signal.</p>

<p>Note that the Cache Manager probes only server machines marked inaccessible in its memory list.
A server machine&#39;s absence from the output does not necessarily mean that it is functioning,
because it possibly is not included in the memory list at all (if,
for example,
the Cache Manager has not contacted it recently).
For the same reason,
the output is likely to vary on different client machines.</p>

<p>Unlike most <b>fs</b> commands,
the fs checkservers command does not refer to the AFSCELL environment variable.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OPTIONS"
>OPTIONS</a></h1>

<dl>
<dt><a name="-cell_&#60;cell_to_check&#62;"
><b>-cell</b> &#60;<i>cell to check</i>&#62;</a></dt>

<dd>
<p>Names each cell in which to probe server machines marked as inaccessible.
Provide the fully qualified domain name,
or a shortened form that disambiguates it from the other cells listed in the local <em>/usr/vice/etc/CellServDB</em> file.
Combine this argument with the <b>-fast</b> flag if desired,
but not with the <b>-all</b> flag.
Omit both this argument and the <b>-all</b> flag to probe machines in the local cell only.</p>

<dt><a name="-all"
><b>-all</b></a></dt>

<dd>
<p>Probes all machines in the Cache Manager&#39;s memory list that are marked inaccessible.
Combine this argument with the <b>-fast</b> flag if desired,
but not with the <b>-cell</b> argument.
Omit both this flag and the <b>-cell</b> argument to probe machines in the local cell only.</p>

<dt><a name="-fast"
><b>-fast</b></a></dt>

<dd>
<p>Displays the Cache Manager&#39;s current list of machines that are inaccessible,
rather than sending new probes.
The output can as old as the current setting of the probe interval (by default three minutes,
and maximum ten minutes).</p>

<dt><a name="-interval_&#60;seconds_between_probes&#62;"
><b>-interval</b> &#60;<i>seconds between probes</i>&#62;</a></dt>

<dd>
<p>Sets or reports the number of seconds between the Cache Manager&#39;s probes to machines in the memory list that are marked inaccessible:</p>

<ul><li><p>To set the interval,
specify a value from the range between 1 and <code>600</code> (10 minutes); the default is <code>180</code> (three minutes).
The issuer must be logged in as the local superuser <code>root</code>.
The altered setting persists until again changed with this command,
or until the machine reboots,
at which time the setting returns to the default.</p></li><li><p>Provide a value of <code>0</code> (zero) to display the current interval setting.
No privilege is required.
Do not combine this argument with any other.</p></li></ul>

<dt><a name="-help"
><b>-help</b></a></dt>

<dd>
<p>Prints the online help for this command.
All other valid options are ignored.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OUTPUT"
>OUTPUT</a></h1>

<p>If there are no machines marked as inaccessible,
or if all of them now respond to the Cache Manager&#39;s probe,
the output is:</p>

<pre>   All servers are running.</pre>

<p>Note that this message does not mean that all server machines in each relevant cell are running. The output indicates the status of only those machines that the Cache Manager probes.</p>

<p>If a machine fails to respond to the probe within the timeout period, the output begins with the string</p>

<pre>   These servers unavailable due to network or server problems:</pre>

<p>and lists the hostname of each machine on its own line. The Cache Manager stores machine records by Internet address, so the format of each hostname (uppercase or lowercase letters, or an Internet address in dotted decimal format) depends on how the local cell&#39;s name service translates it at the time the command is issued. If a server machine is multihomed, the output lists only one of its interfaces (usually, the currently most preferred one).</p>

<p>If the <b>-interval</b> argument is provided with a value between <code>1</code> and <code>600</code>, there is no output. If the value is <code>0</code>, the output reports the probe interval as follows:</p>

<pre>   The current down server probe interval is &#60;interval&#62; secs</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXAMPLES"
>EXAMPLES</a></h1>

<p>The following command displays the Cache Manager&#39;s current list of unresponsive machines in the local cell, rather than probing them again. The output indicates that if there were any machines marked inaccessible, they all responded to the previous probe.</p>

<pre>   % fs checkservers -fast
   All servers are running.</pre>

<p>The following example probes machines in the Cache Manager&#39;s memory list that belong to the <code>stateu.edu</code> cell:</p>

<pre>   % fs checkservers -cell stateu.edu
   All servers are running.</pre>

<p>The following example probes all server machines in the Cache Manager&#39;s memory list. It reports that two machines did not respond to the probe.</p>

<pre>   % fs checkservers -all
   These servers unavailable due to network or server problems:
   fs1.abc.com SV3.STATE.EDU.</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PRIVILEGE_REQUIRED"
>PRIVILEGE REQUIRED</a></h1>

<p>To set the probe interval, the issuer must be logged in as the local superuser <code>root</code>. Otherwise, no privilege is required.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../5/CellServDB.html" class="podlinkman"
>CellServDB(5)</a>, <a href="../5/ThisCell.html" class="podlinkman"
>ThisCell(5)</a>, <a href="../1/fs_newcell.html" class="podlinkpod"
>fs_newcell(1)</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>IBM Corporation 2000. &#60;http://www.ibm.com/&#62; All Rights Reserved.</p>

<p>This documentation is covered by the IBM Public License Version 1.0. It was converted from HTML to POD by software written by Chas Williams and Russ Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.</p>

<!-- end doc -->

</body></html>
