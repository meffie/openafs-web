<html><head><title>klog.krb5</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="style" type="text/css" href="../style.css" media="all" >

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.03,
  using Pod::Simple::PullParser v2.02,
  under Perl v5.010000 at Tue Nov 11 07:45:44 2008 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="indexlink"><a href="../index.html">Back to Index</a></p>
<a name='___top' class='dummyTopAnchor' ></a>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>klog.krb5 - Authenticates to Kerberos and obtains a token</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>


<div class="synopsis">


<p><b>klog.krb5</b> [<b>-x</b>] [<b>-principal</b>&#160;&#60;<i>user&#160;name</i>&#62;] [-password &#60;<i>user&#39;s password</i>&#62;] [<b>-cell</b>&#160;&#60;<i>cell&#160;name</i>&#62;] [<b>-k</b>&#160;&#60;<i>realm</i>&#62;] [<b>-pipe</b>] [<b>-silent</b>] [<b>-lifetime</b>&#160;&#60;<i>ticket&#160;lifetime&#160;in&#160;hh[:mm[:ss]]</i>&#62;] [<b>-setpag</b>] [<b>-tmp</b>] [<b>-noprdb</b>] [<b>-unwrap</b>] [<b>-help</b>]</p>

<p><b>klog.krb5</b> [<b>-x</b>] [<b>-pr</b>&#160;&#60;<i>user&#160;name</i>&#62;] [<b>-pa</b>&#160;&#60;<i>user&#39;s&#160;password</i>&#62;] [<b>-c</b>&#160;&#60;<i>cell&#160;name</i>&#62;] <b>[<b>-k</b> &#60;<i>realm</i>&#62;]</b> [<b>-pi</b>] [<b>-si</b>] [<b>-l</b>&#160;&#60;<i>ticket&#160;lifetime&#160;in&#160;hh[:mm[:ss]]</i>&#62;] [<b>-se</b>] [<b>-t</b>] [<b>-n</b>] [<b>-u</b>] [<b>-h</b>]</p>


</div>


<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The <b>klog.krb5</b> command obtains a Kerberos v5 ticket from a Kerberos KDC and,
from the ticket,
an AFS token and then stores it in the Cache Manager.
The Cache Manager keeps the token in kernel memory and uses it when obtaining authenticated access to the AFS filespace.
This command does not affect the issuer&#39;s identity (UNIX UID) on the local file system.</p>

<p>By default,
the command interpreter obtains a token for the AFS user name that matches the issuer&#39;s local user name.
To specify an alternate user,
include the <b>-principal</b> argument.
The user named by the <b>-principal</b> argument does not have to appear in the local password file (the <em>/etc/passwd</em> file or equivalent).</p>

<p>By default,
the command interpreter obtains a token for the local cell,
as defined by the AFSCELL environment variable set in the command shell or by the <em>/usr/vice/etc/ThisCell</em> file on the local machine.
To specify an alternate cell,
include the <b>-cell</b> argument.
A user can have tokens in multiple cells simultaneously,
but only one token per cell per connection to the client machine.
If the user&#39;s credential structure already contains a token for the requested cell,
the token resulting from this command replaces it.</p>

<p>By default,
the command interpreter obtains a Kerberos ticket for the local realm.
To specify a different Kerberos realm,
include the <b>-k</b> argument.
The Kerberos realm name need not match the AFS cell name.
<b>klog.krb5</b> will request a ticket for the principal <code>afs/<i>cell</i></code> where <i>cell</i> is the cell name for which the user is requesting tokens,
falling back on the principal <code>afs</code> if that principal does not work.</p>

<p>The lifetime of the token resulting from this command is the smallest of the following:</p>

<ul><li><p>The lifetime specified by the issuer with the <b>-lifetime</b> argument if that argument was given.</p></li><li><p>The maximum ticket lifetime recorded for the <code>afs/<i>cell</i></code> principal in thet Kerberos database.</p></li><li><p>The maximum ticket lifetime recorded in the specified user&#39;s Kerberos database entry.</p></li></ul>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CAUTIONS"
>CAUTIONS</a></h1>

<p>By default,
this command does not create a new process authentication group (PAG); see the description of the <b>pagsh</b> command to learn about PAGs.
If a cell does not use an AFS-modified login utility,
users must include <b>-setpag</b> option to this command,
or issue the <b>pagsh</b> command before this one,
to have their tokens stored in a credential structure that is identified by PAG rather than by local UID.
Users should be aware that <b>-setpag</b> will not work on some systems,
most notably recent Linux systems,
and using <b>pagsh</b> is preferrable and more reliable.</p>

<p>When a credential structure is identified by local UID,
the potential security exposure is that the local superuser <code>root</code> can use the UNIX <b>su</b> command to assume any other identity and automatically inherit the tokens associated with that UID.
Identifying the credential structure by PAG makes it more difficult (but not impossible) for the local superuser to obtain tokens of other users.</p>

<p>If the <b>-password</b> argument is used,
the specified password cannot begin with a hyphen,
because it is interpreted as another option name.
Use of the <b>-password</b> argument is not recommended in any case.</p>

<p>By default,
it is possible to issue this command on a properly configured NFS client machine that is accessing AFS via the NFS/AFS Translator,
assuming that the NFS client machine is a supported system type.
However,
if the translator machine&#39;s administrator has enabled UID checking by including the <b>-uidcheck on</b> argument to the <b>fs exportafs</b> command,
the command fails with an error message similar to the following:</p>

<pre>   Warning: Remote pioctl to &#60;translator_machine&#62; has failed (err=8). . .
   Unable to authenticate to AFS because a pioctl failed.</pre>

<p>Enabling UID checking means that the credential structure in which tokens are stored on the translator machine must be identified by a UID that matches the local UID of the process that is placing the tokens in the credential structure. After the <b>klog.krb5</b> command interpreter obtains the token on the NFS client, it passes it to the remote executor daemon on the translator machine, which makes the system call that stores the token in a credential structure on the translator machine. The remote executor generally runs as the local superuser <code>root</code>, so in most cases its local UID (normally zero) does not match the local UID of the user who issued the <b>klog.krb5</b> command on the NFS client machine.</p>

<p>Issuing the <b>klog.krb5</b> command on an NFS client machine creates a security exposure: the command interpreter passes the token across the network to the remote executor daemon in clear text mode.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OPTIONS"
>OPTIONS</a></h1>

<dl>
<dt><a name="-x"
><b>-x</b></a></dt>

<dd>
<p>Appears only for backwards compatibility. Its former function is now the default behavior of this command.</p>

<dt><a name="-principal_&#60;user_name&#62;"
><b>-principal</b> &#60;<i>user name</i>&#62;</a></dt>

<dd>
<p>Specifies the user name to authenticate. If this argument is omitted, the default value is the local user name.</p>

<dt><a name="-password_&#60;user&#39;s_password&#62;"
><b>-password</b> &#60;<i>user&#39;s password</i>&#62;</a></dt>

<dd>
<p>Specifies the issuer&#39;s password (or that of the alternate user identified by the <b>-principal</b> argument). Omit this argument to have the command interpreter prompt for the password, in which case it does not echo visibly in the command shell.</p>

<dt><a name="-cell_&#60;cell_name&#62;"
><b>-cell</b> &#60;<i>cell name</i>&#62;</a></dt>

<dd>
<p>Specifies the cell for which to obtain a token. During a single login session on a given machine, a user can be authenticated in multiple cells simultaneously, but can have only one token at a time for each of them (that is, can only authenticate under one identity per cell per session on a machine). It is acceptable to abbreviate the cell name to the shortest form that distinguishes it from the other cells listed in the <em>/usr/vice/etc/CellServDB</em> file on the client machine on which the command is issued.</p>

<p>If this argument is omitted, the command is executed in the local cell, as defined</p>

<ul><li><p>First, by the value of the environment variable AFSCELL.</p></li><li><p>Second, in the <em>/usr/vice/etc/ThisCell</em> file on the client machine on which the command is issued.</p></li></ul>

<dt><a name="-k_&#60;realm&#62;"
><b>-k</b> &#60;<i>realm</i>&#62;</a></dt>

<dd>
<p>Obtain tickets and tokens from the &#60;<i>realm</i>&#62; Kerberos realm. If this option is not given, <b>klog.krb5</b> defaults to using the default local realm. The Kerberos realm name need not match the AFS cell name.</p>

<dt><a name="-pipe"
><b>-pipe</b></a></dt>

<dd>
<p>Suppresses all output to the standard output stream, including prompts and error messages. The <b>klog.krb5</b> command interpreter expects to receive the password from the standard input stream. Do not use this argument; it is designed for use by application programs rather than human users.</p>

<dt><a name="-silent"
><b>-silent</b></a></dt>

<dd>
<p>Suppresses some of the trace messages that the <b>klog.krb5</b> command produces on the standard output stream by default. It still reports on major problems encountered.</p>

<dt><a name="-lifetime_&#60;ticket_lifetime"
><b>-lifetime</b> &#60;<i>ticket lifetime</i></a></dt>

<dd>
<p>Requests a specific lifetime for the token. Provide a number of hours and optionally minutes and seconds in the format <i>hh</i>[<b>:</b><i>mm</i>[<b>:</b><i>ss</i>]].</p>

<dt><a name="-setpag"
><b>-setpag</b></a></dt>

<dd>
<p>Creates a process authentication group (PAG) prior to requesting authentication. The token is associated with the newly created PAG.</p>

<dt><a name="-tmp"
><b>-tmp</b></a></dt>

<dd>
<p>Creates a Kerberos-style ticket file rather than only obtaining tokens. The ticket file will be stored in the default Kerberos ticket cache location, which is usually in the <em>/tmp</em> directory of the local machine (but depends on the Kerberos implementation used).</p>

<dt><a name="-noprdb"
><b>-noprdb</b></a></dt>

<dd>
<p>By default, <b>klog.krb5</b> looks up the user&#39;s AFS ID in the Protection Server and associates the token with that AFS ID. This is helpful when looking at the output of commands like <b>tokens</b> but is not required. If this option is given, this behavior is suppressed and <b>klog.krb5</b> will store the token under a generic name. You may wish this if, for example, you have problems contacting the Protection Server for an AFS cell for some reason.</p>

<dt><a name="-unwrap"
><b>-unwrap</b></a></dt>

<dd>
<p>Normally, <b>klog.krb5</b> uses the Kerberos service ticket for the AFS principal as the AFS token. If this option is given, <b>klog.krb5</b> creates a different, simplified AFS token form based on the service ticket (the so-called &#34;rxkad 2b&#34; token). Normally, this is not necessary. However, if you are using older OpenAFS software that cannot handle large ticket sizes in conjunction with Active Directory as the Kerberos server, using <b>-unwrap</b> can shrink the AFS token size so that older software can handle it more easily.</p>

<dt><a name="-help"
><b>-help</b></a></dt>

<dd>
<p>Prints the online help for this command. All other valid options are ignored.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OUTPUT"
>OUTPUT</a></h1>

<p>If the <b>-tmp</b> flag is included, the following message confirms that a Kerberos ticket cache was created:</p>

<pre>   Wrote ticket file to /tmp/krb5cc_1000_rENJoZ</pre>

<p>The path to the cache will vary, of course.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXAMPLES"
>EXAMPLES</a></h1>

<p>Most often, this command is issued without arguments. The appropriate password is for the person currently logged into the local system. The ticket&#39;s lifetime is calculated as described in <a href="./DESCRIPTION.html" class="podlinkpod"
>DESCRIPTION</a>.</p>

<pre>   % klog.krb5
   Password for user@EXAMPLE.ORG:</pre>

<p>The following example authenticates the user as admin in the ABC Corporation&#39;s test cell:</p>

<pre>   % klog.krb5 -principal admin -cell test.abc.com
   Password for admin@ABC.COM:</pre>

<p>In the following, the issuer requests a ticket lifetime of 104 hours 30 minutes (4 days 8 hours 30 minutes).</p>

<pre>   % klog.krb5 -lifetime 104:30
   Password for user@EXAMPLE.ORG:</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PRIVILEGE_REQUIRED"
>PRIVILEGE REQUIRED</a></h1>

<p>None</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../1/aklog.html" class="podlinkman"
>aklog(1)</a>, <a href="../1/fs_exportafs.html" class="podlinkpod"
>fs_exportafs(1)</a>, <a href="../1/pagsh.html" class="podlinkman"
>pagsh(1)</a>, <a href="../1/tokens.html" class="podlinkman"
>tokens(1)</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>IBM Corporation 2000. &#60;http://www.ibm.com/&#62; All Rights Reserved.</p>

<p>This documentation is covered by the IBM Public License Version 1.0. It was converted from HTML to POD by software written by Chas Williams and Russ Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.</p>
<p class="indexlink"><a href="../index.html">Back to Index</a></p>

<!-- end doc -->

</body></html>
