<html><head><title>backup_dbverify</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="style" type="text/css" href="../style.css" media="all" >

</head>
<body class='pod'>
<!--
  generated by OpenAFS::HTML v1.1,
  using Pod::Simple::PullParser v2.02,
  under Perl v5.010000 at Sat Mar 29 18:17:47 2008 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to OpenAFS::HTML, and/or subclassing OpenAFS::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of OpenAFS::HTML for advice.
   See 'perldoc OpenAFS::HTML' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>backup_dbverify - Checks the integrity of the Backup Database</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>


<div class="synopsis">


<p><b>backup dbverify</b> [<b>-detail</b>] [<b>-localauth</b>] [<b>-cell</b>&#160;&#60;<i>cell&#160;name</i>&#62;] [<b>-help</b>]</p>

<p><b>backup db</b> [<b>-d</b>] [<b>-l</b>] [<b>-c</b>&#160;&#60;<i>cell&#160;name</i>&#62;] [<b>-h</b>]</p>


</div>


<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The <b>backup dbverify</b> command checks the integrity of the Backup Database.
The command&#39;s output indicates whether the Backup Database is damaged (data is corrupted) or not.
If the Backup Database is undamaged,
it is safe to continue using it.
If it is corrupted,
discontinue any backup operations until it is repaired.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CAUTIONS"
>CAUTIONS</a></h1>

<p>While this command runs,
no other backup operation can access the Backup Database; the other commands do not run until this command completes.
Avoid issuing this command when other backup operations are likely to run.
The <b>backup savedb</b> command repairs some types of corruption.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OPTIONS"
>OPTIONS</a></h1>

<dl>
<dt><a name="-detail"
><b>-detail</b></a></dt>

<dd>
<p>Reports the number of orphaned blocks found,
any inconsistencies,
and the name of the server machine running the Backup Server that is checking its copy of the database.</p>

<dt><a name="-localauth"
><b>-localauth</b></a></dt>

<dd>
<p>Constructs a server ticket using a key from the local <em>/usr/afs/etc/KeyFile</em> file.
The <b>backup</b> command interpreter presents it to the Backup Server,
Volume Server and VL Server during mutual authentication.
Do not combine this flag with the <b>-cell</b> argument.
For more details,
see <a href="../8/backup.html" class="podlinkman"
>backup(8)</a>.</p>

<dt><a name="-cell_&#60;cell_name&#62;"
><b>-cell</b> &#60;<i>cell name</i>&#62;</a></dt>

<dd>
<p>Names the cell in which to run the command.
Do not combine this argument with the <b>-localauth</b> flag.
For more details,
see <a href="../8/backup.html" class="podlinkman"
>backup(8)</a>.</p>

<dt><a name="-help"
><b>-help</b></a></dt>

<dd>
<p>Prints the online help for this command.
All other valid options are ignored.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OUTPUT"
>OUTPUT</a></h1>

<p>The command displays one of the following two messages:</p>

<dl>
<dt><a name="Database_OK"
>Database OK</a></dt>

<dd>
<p>The database is undamaged and can be used.</p>

<dt><a name="Database_not_OK"
>Database not OK</a></dt>

<dd>
<p>The database is damaged.
You can use the backup savedb command to repair many kinds of corruption as it creates a backup copy.
For more detailed instructions,
see the <i>IBM AFS Administration Guide</i> chapter about performing backup operations.</p>
</dd>
</dl>

<p>The <b>-detail</b> flag provides additional information:</p>

<ul><li><p>The number of <i>orphan blocks</i> found.
These are ranges of memory that the Backup Server preallocated in the database but cannot use.
Orphan blocks do not interfere with database access,
but do waste disk space.
To free the unusable space,
dump the database to tape by using the <b>backup savedb</b> command,
and then restore it by using the <b>backup restoredb</b> command.</p></li><li><p>Any inconsistencies in the database,
such as invalid hostnames for Tape Coordinator machines.</p></li><li><p>The name of the database server machine on which the Backup Database was checked,
designated as the <code>Database checker</code>.
For a detailed trace of the verification operation,
see the <em>/usr/afs/logs/BackupLog</em> file on the indicated machine.
You can use the <b>bos getlog</b> command to display it.</p></li></ul>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXAMPLES"
>EXAMPLES</a></h1>

<p>The following command confirms that the Backup Database is undamaged:</p>

<pre>   % backup dbverify
   Database OK</pre>

<p>The following command confirms that the Backup Database is undamaged and that it has no orphan blocks or invalid Tape Coordinator entries. The Backup Server running on the machine <code>db1.abc.com</code> checked its copy of the Database.</p>

<pre>   % backup dbverify -detail
   Database OK
   Orphan blocks 0
   Database checker was db1.abc.com</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PRIVILEGE_REQUIRED"
>PRIVILEGE REQUIRED</a></h1>

<p>The issuer must be listed in the <em>/usr/afs/etc/UserList</em> file on every machine where the Backup Server is running, or must be logged onto a server machine as the local superuser <code>root</code> if the <b>-localauth</b> flag is included.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../5/BackupLog.html" class="podlinkman"
>BackupLog(5)</a>, <a href="../8/backup.html" class="podlinkman"
>backup(8)</a>, <a href="../8/backup_restoredb.html" class="podlinkpod"
>backup_restoredb(8)</a>, <a href="../8/backup_savedb.html" class="podlinkpod"
>backup_savedb(8)</a>, <a href="../8/bos_getlog.html" class="podlinkpod"
>bos_getlog(8)</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>IBM Corporation 2000. &#60;http://www.ibm.com/&#62; All Rights Reserved.</p>

<p>This documentation is covered by the IBM Public License Version 1.0. It was converted from HTML to POD by software written by Chas Williams and Russ Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.</p>

<!-- end doc -->

</body></html>
