<html><head><title>vldb_convert</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="style" type="text/css" href="../style.css" media="all" >

</head>
<body class='pod'>
<!--
  generated by OpenAFS::HTML v1.1,
  using Pod::Simple::PullParser v2.02,
  under Perl v5.010000 at Fri Jun 27 16:26:12 2008 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to OpenAFS::HTML, and/or subclassing OpenAFS::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of OpenAFS::HTML for advice.
   See 'perldoc OpenAFS::HTML' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>vldb_convert - Convert the VLDB to/from Transarc AFS versions 3.1-3.4a</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>


<div class="synopsis">


<p><b>vldb_convert</b> [<b>initcmd</b>] [<b>-to</b>]&#160;&#60;<i>AFS&#160;version&#160;goal</i>&#62; [<b>-from</b>]&#160;&#60;<i>current&#160;AFS&#160;version</i>&#62; [<b>-path</b>]&#160;&#60;<i>path&#160;to&#160;VLDB&#160;file</i>&#62; [<b>-showversion</b>] [<b>-dumpvldb</b>] [<b>-help</b>]</p>


</div>


<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The <b>vldb_convert</b> command is used to convert legacy Transarc 3.1-3.4 VLDB database files between versions.
This command is not needed when using OpenAFS except in the case of preparing to migrate a pre-3.4 version of Transarc AFS to OpenAFS.</p>

<p>In order to convert the VLDB file,
do the following:</p>

<ol><li><p>Shutdown the <b>vlserver</b> process on all server machines.
<b>vlserver</b> is typically run only on the Cell servers,
which must be listed in <em>CellServDB</em> or DNS.</p></li><li><p>Backup the VLDB file <em>/usr/afs/db/vldb.DB0</em> on the sync site to a safe place.
Typically,
the sync site if the machine with the lowest IP address.</p></li><li><p>Remove the <em>/usr/afs/db/vldb.DBSYS1</em> file from all cell server machines.</p></li><li><p>Remove the <em>/usr/afs/db/vldb.DB0</em> file from the non-sync site server machines.</p></li><li><p>Run the <b>vldb_convert</b> command on the VLDB file using the following command:
<pre>   # vldb_convert -path /usr/afs/db/vldb.DB0</pre>
</p></li><li><p>Copy the new version of the vlserver binaries to all Cell servers.</p></li><li><p>Restart the vlserver process on all Cell servers. The new VLDB will be distributed to all of the Cell servers.</p></li><li><p>Confirm that all Cell servers are synchronized and that the vldb looks in good shape.</p></li></ol>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CAUTIONS"
>CAUTIONS</a></h1>

<p>Backup the VLDB file to a different directory or machine before performing the upgrade. Be sure that all vlserver processes are always running the same version. This requires downtime, but for this conversion, all vlserver instances must be at the same version. This restriction is relaxed in OpenAFS.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OPTIONS"
>OPTIONS</a></h1>

<dl>
<dt><a name="[initcmd]"
>[<b>initcmd</b>]</a></dt>

<dd>
<p>This is an optional string that does nothing.</p>

<dt><a name="[-to]_&#60;AFS_version_goal&#62;"
>[<b>-to</b>] &#60;<i>AFS version goal</i>&#62;</a></dt>

<dd>
<p>This option is required when downgrading or when upgrading to a version less than 3.4. Specify 1, 2, 3, or 4 to choose version 3.1, 3.2, 3.3, or 3,4 respectively. This defaults to version 3.4.</p>

<dt><a name="[-from]_&#60;current_AFS_version&#62;"
>[<b>-from</b>] &#60;<i>current AFS version</i>&#62;</a></dt>

<dd>
<p>This option is required when downgrading. Specify 1, 2, 3, or 4 to choose version 3.1, 3.2, 3.3, or 3.4 respectively.</p>

<dt><a name="[-path]_&#60;path_to_VLDB_file&#62;"
>[<b>-path</b>] &#60;<i>path to VLDB file</i>&#62;</a></dt>

<dd>
<p>Specifies the path the VLDB file. This defaults to <em>/usr/afs/db/vldb.DB0</em> and only needs to be used if the VLDB file is not in the default path..</p>

<dt><a name="-showversion"
><b>-showversion</b></a></dt>

<dd>
<p>Shows the current version of the VLDB. This option can only be used by itself.</p>

<dt><a name="-dumpvldb"
><b>-dumpvldb</b></a></dt>

<dd>
<p>Produces verbose debugging output during the conversion process.</p>

<dt><a name="-help"
><b>-help</b></a></dt>

<dd>
<p>Prints the online help for this command. All other valid options are ignored.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PRIVILEGE_REQUIRED"
>PRIVILEGE REQUIRED</a></h1>

<p>The issuer must have read and write access to the file <em>/usr/afs/db/vldb.DB0</em>. This usually means that root access is required on the cell server machines.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../8/vlserver.html" class="podlinkman"
>vlserver(8)</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>Copyright 2008 Jason Edgecombe &#60;jason@rampaginggeek.com&#62;</p>

<p>This documentation is covered by the BSD License as written in the doc/LICENSE file. This man page was written by Jason Edgecombe for OpenAFS.</p>

<!-- end doc -->

</body></html>
