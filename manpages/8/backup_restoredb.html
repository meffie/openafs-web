<html><head><title>backup_restoredb</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="style" type="text/css" href="../style.css" media="all" >

</head>
<body class='pod'>
<!--
  generated by OpenAFS::HTML v1.1,
  using Pod::Simple::PullParser v2.02,
  under Perl v5.010000 at Sat Mar 29 18:17:48 2008 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to OpenAFS::HTML, and/or subclassing OpenAFS::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of OpenAFS::HTML for advice.
   See 'perldoc OpenAFS::HTML' for more info.

-->

<!-- start doc -->
<a name='___top' class='dummyTopAnchor' ></a>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>backup_restoredb - Restores a saved copy of the Backup Database</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>


<div class="synopsis">


<p><b>backup restoredb</b> [<b>-portoffset</b>&#160;&#60;<i>TC&#160;port&#160;offset</i>&#62;] [<b>-localauth</b>] [<b>-cell</b>&#160;&#60;<i>cell&#160;name</i>&#62;] [<b>-help</b>]</p>

<p><b>backup res</b> [<b>-p</b>&#160;&#60;<i>TC&#160;port&#160;offset</i>&#62;] [<b>-l</b>] [<b>-c</b>&#160;&#60;<i>cell&#160;name</i>&#62;] [<b>-h</b>]</p>


</div>


<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The <b>backup restoredb</b> command restores to the Backup Server machine&#39;s local disk a version of the Backup Database previously written to tape by using the <b>backup savedb</b> command.</p>

<p>(If the <code>FILE YES</code> instruction appears in the <em>/usr/afs/backup/CFG_<i>device_name</i></em> file associated with the specified port offset,
then the <b>backup restoredb</b> command restores data from the backup data file listed for that port offset in the Tape Coordinator&#39;s <em>/usr/afs/backup/tapeconfig</em> file,
instead of from tape.
For the sake of clarity,
the following text refers to tapes only,
but the Backup System handles backup data files in much the same way.)</p>

<p>The most common reason to run this command is to replace a corrupted or otherwise damaged Backup Database; use the <b>backup dbverify</b> command to determine the database&#39;s status.
The command can also be used to restore records that were removed from the database when the <b>-archive</b> argument was included on a previous <b>backup savedb</b> command.</p>

<p>The command completely overwrites the existing Backup Database records for volume sets,
Tape Coordinators,
and the dump hierarchy with the corresponding information from the saved version.
It does not overwrite existing dump records,
but instead interleaves the records from the copy being restored.
If both the existing database (on the Backup Server machine&#39;s disk) and the copy being restored include a record about the same dump,
the Backup System retains the one in the existing database.</p>

<p>The Tape Coordinator&#39;s default response to this command is to access the first tape it needs by invoking the <code>MOUNT</code> instruction in the local <em>/usr/afs/backup/CFG_<i>device_name</i></em> file,
or by prompting the backup operator to insert the tape if there is no <code>MOUNT</code> instruction.
However,
if the <code>AUTOQUERY NO</code> instruction appears in the <em>CFG_<i>device_name</i></em> file,
or if the issuer of the <b>butc</b> command included the <b>-noautoquery</b> flag,
the Tape Coordinator instead expects the tape to be in the device already.
If it is not,
or is the wrong tape,
the Tape Coordinator invokes the <code>MOUNT</code> instruction or prompts the operator.
It also invokes the <code>MOUNT</code> instruction or prompts for any additional tapes needed to complete the restore operation; the backup operator must arrange to provide them.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CAUTIONS"
>CAUTIONS</a></h1>

<p>If the database is corrupted,
do not attempt to restore a saved database on top of it.
Instead,
use the instructions for repairing a corrupted database in the <i>IBM AFS Administration Guide</i> chapter about performing backup operations.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OPTIONS"
>OPTIONS</a></h1>

<dl>
<dt><a name="-portoffset_&#60;TC_port_offset&#62;"
><b>-portoffset</b> &#60;<i>TC port offset</i>&#62;</a></dt>

<dd>
<p>Specifies the port offset number of the Tape Coordinator handling the tapes for this operation.</p>

<dt><a name="-localauth"
><b>-localauth</b></a></dt>

<dd>
<p>Constructs a server ticket using a key from the local <em>/usr/afs/etc/KeyFile</em> file.
The <b>backup</b> command interpreter presents it to the Backup Server,
Volume Server and VL Server during mutual authentication.
Do not combine this flag with the <b>-cell</b> argument.
For more details,
see <a href="../8/backup.html" class="podlinkman"
>backup(8)</a>.</p>

<dt><a name="-cell_&#60;cell_name&#62;"
><b>-cell</b> &#60;<i>cell name</i>&#62;</a></dt>

<dd>
<p>Names the cell in which to run the command.
Do not combine this argument with the <b>-localauth</b> flag.
For more details,
see <a href="../8/backup.html" class="podlinkman"
>backup(8)</a>.</p>

<dt><a name="-help"
><b>-help</b></a></dt>

<dd>
<p>Prints the online help for this command.
All other valid options are ignored.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXAMPLES"
>EXAMPLES</a></h1>

<p>The following example shows the Backup Database being restored from the Tape Coordinator with port offset 0:</p>

<pre>   % backup restoredb</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PRIVILEGE_REQUIRED"
>PRIVILEGE REQUIRED</a></h1>

<p>The issuer must be listed in the <em>/usr/afs/etc/UserList</em> file on every machine where the Backup Server is running, or must be logged onto a server machine as the local superuser <code>root</code> if the <b>-localauth</b> flag is included.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../5/butc.html" class="podlinkman"
>butc(5)</a>, <a href="../8/backup.html" class="podlinkman"
>backup(8)</a>, <a href="../8/backup_dbverify.html" class="podlinkpod"
>backup_dbverify(8)</a>, <a href="../8/backup_savedb.html" class="podlinkpod"
>backup_savedb(8)</a>, <a href="../8/butc.html" class="podlinkman"
>butc(8)</a></p>

<p><i>IBM AFS Administration Guide</i></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>IBM Corporation 2000. &#60;http://www.ibm.com/&#62; All Rights Reserved.</p>

<p>This documentation is covered by the IBM Public License Version 1.0. It was converted from HTML to POD by software written by Chas Williams and Russ Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.</p>

<!-- end doc -->

</body></html>
